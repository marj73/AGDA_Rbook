<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Basic operations with geodata in R | Advanced Geospatial Data Analysis with R – Applications in Geosciences</title>
  <meta name="description" content="Chapter 2 Basic operations with geodata in R | Advanced Geospatial Data Analysis with R – Applications in Geosciences" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Basic operations with geodata in R | Advanced Geospatial Data Analysis with R – Applications in Geosciences" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Basic operations with geodata in R | Advanced Geospatial Data Analysis with R – Applications in Geosciences" />
  
  
  

<meta name="author" content="Dr. Marj Tonini, Haokun Liu" />


<meta name="date" content="2024-09-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="gwss.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/AGDA_ImageCover.webp"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-overview"><i class="fa fa-check"></i>Book overview</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computing-lab"><i class="fa fa-check"></i>Computing lab</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#target-audience"><i class="fa fa-check"></i>Target audience</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-information"><i class="fa fa-check"></i>Authors information</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-journey-of-learning-integrating-geospatial-data-analysis-with-data-science"><i class="fa fa-check"></i>My Journey of Learning: Integrating Geospatial Data Analysis with Data Science</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#r-packages"><i class="fa fa-check"></i><b>1.1.1</b> R Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#some-tips"><i class="fa fa-check"></i><b>1.1.2</b> Some tips</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#r-commands-online-resources"><i class="fa fa-check"></i><b>1.1.3</b> R Commands (online resources)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#r-markdown"><i class="fa fa-check"></i><b>1.2</b> R Markdown</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#data-type-in-computational-analysis"><i class="fa fa-check"></i><b>1.3</b> Data type in computational analysis</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>1.3.1</b> Variables</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#data-structure-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Data structure in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geodata.html"><a href="geodata.html"><i class="fa fa-check"></i><b>2</b> Basic operations with geodata in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="geodata.html"><a href="geodata.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="geodata.html"><a href="geodata.html#plotting-vector-dataset"><i class="fa fa-check"></i><b>2.2</b> Plotting vector dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="geodata.html"><a href="geodata.html#package-sf-for-vector-dataset"><i class="fa fa-check"></i><b>2.2.1</b> Package <strong><em>sf</em></strong> for vector dataset</a></li>
<li class="chapter" data-level="2.2.2" data-path="geodata.html"><a href="geodata.html#plot-vector-features"><i class="fa fa-check"></i><b>2.2.2</b> Plot vector features</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="geodata.html"><a href="geodata.html#plotting-raster-dataset"><i class="fa fa-check"></i><b>2.3</b> Plotting raster dataset</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="geodata.html"><a href="geodata.html#terra-package-and-raster-dataset"><i class="fa fa-check"></i><b>2.3.1</b> Terra package and raster dataset</a></li>
<li class="chapter" data-level="2.3.2" data-path="geodata.html"><a href="geodata.html#plot-raster-features"><i class="fa fa-check"></i><b>2.3.2</b> Plot raster features</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="geodata.html"><a href="geodata.html#geodata-manipulation"><i class="fa fa-check"></i><b>2.4</b> Geodata manipulation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="geodata.html"><a href="geodata.html#manipulate-tabular-datasets"><i class="fa fa-check"></i><b>2.4.1</b> Manipulate tabular datasets</a></li>
<li class="chapter" data-level="2.4.2" data-path="geodata.html"><a href="geodata.html#pipes-chaining-of-multiple-operations"><i class="fa fa-check"></i><b>2.4.2</b> Pipes: chaining of multiple operations</a></li>
<li class="chapter" data-level="2.4.3" data-path="geodata.html"><a href="geodata.html#join-table"><i class="fa fa-check"></i><b>2.4.3</b> Join table</a></li>
<li class="chapter" data-level="2.4.4" data-path="geodata.html"><a href="geodata.html#mapping-with-ggplot2"><i class="fa fa-check"></i><b>2.4.4</b> Mapping with ggplot2</a></li>
<li class="chapter" data-level="2.4.5" data-path="geodata.html"><a href="geodata.html#cropping-ratser"><i class="fa fa-check"></i><b>2.4.5</b> Cropping ratser</a></li>
<li class="chapter" data-level="2.4.6" data-path="geodata.html"><a href="geodata.html#display-the-categorical-variables-of-a-raster"><i class="fa fa-check"></i><b>2.4.6</b> Display the categorical variables of a raster</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="geodata.html"><a href="geodata.html#further-reading"><i class="fa fa-check"></i><b>2.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gwss.html"><a href="gwss.html"><i class="fa fa-check"></i><b>3</b> Geographically Weighted Summary Statistics for Geosciences</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gwss.html"><a href="gwss.html#gwss-for-natural-hazards-assessment"><i class="fa fa-check"></i><b>3.1</b> GWSS for natural hazards assessment</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="gwss.html"><a href="gwss.html#the-overall-methodology"><i class="fa fa-check"></i><b>3.1.1</b> The overall methodology</a></li>
<li class="chapter" data-level="3.1.2" data-path="gwss.html"><a href="gwss.html#forest-fires-dataset"><i class="fa fa-check"></i><b>3.1.2</b> Forest fires dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gwss.html"><a href="gwss.html#computing-lab-gwss"><i class="fa fa-check"></i><b>3.2</b> Computing lab: GWSS</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="gwss.html"><a href="gwss.html#load-the-libraries"><i class="fa fa-check"></i><b>3.2.1</b> Load the libraries</a></li>
<li class="chapter" data-level="3.2.2" data-path="gwss.html"><a href="gwss.html#import-the-forest-fire-dataset"><i class="fa fa-check"></i><b>3.2.2</b> Import the forest fire dataset</a></li>
<li class="chapter" data-level="3.2.3" data-path="gwss.html"><a href="gwss.html#forest-fires-spatial-distribution"><i class="fa fa-check"></i><b>3.2.3</b> Forest fires spatial distribution</a></li>
<li class="chapter" data-level="3.2.4" data-path="gwss.html"><a href="gwss.html#compute-the-gwss"><i class="fa fa-check"></i><b>3.2.4</b> Compute the GWSS</a></li>
<li class="chapter" data-level="3.2.5" data-path="gwss.html"><a href="gwss.html#look-at-the-results"><i class="fa fa-check"></i><b>3.2.5</b> Look at the results</a></li>
<li class="chapter" data-level="3.2.6" data-path="gwss.html"><a href="gwss.html#gwss-maps"><i class="fa fa-check"></i><b>3.2.6</b> GWSS maps</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="gwss.html"><a href="gwss.html#conclusions-and-further-analyses"><i class="fa fa-check"></i><b>3.3</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="kde.html"><a href="kde.html"><i class="fa fa-check"></i><b>4</b> Spatio-Temporal Cluster Analysis of GeoEnvironmental Processes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="kde.html"><a href="kde.html#st-clustering-for-fire-management"><i class="fa fa-check"></i><b>4.1</b> ST clustering for fire management</a></li>
<li class="chapter" data-level="4.2" data-path="kde.html"><a href="kde.html#clustering-methods"><i class="fa fa-check"></i><b>4.2</b> Clustering methods</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="kde.html"><a href="kde.html#ripleys-k-function"><i class="fa fa-check"></i><b>4.2.1</b> Ripley’s K-function</a></li>
<li class="chapter" data-level="4.2.2" data-path="kde.html"><a href="kde.html#kernel-density-estimator"><i class="fa fa-check"></i><b>4.2.2</b> Kernel density estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="kde.html"><a href="kde.html#computing-lab-st-clustering"><i class="fa fa-check"></i><b>4.3</b> Computing lab: ST clustering</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="kde.html"><a href="kde.html#load-the-libraries-1"><i class="fa fa-check"></i><b>4.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="4.3.2" data-path="kde.html"><a href="kde.html#import-the-forest-fire-dataset-1"><i class="fa fa-check"></i><b>4.3.2</b> Import the forest fire dataset</a></li>
<li class="chapter" data-level="4.3.3" data-path="kde.html"><a href="kde.html#forest-fires-subsets-based-on-the-size-of-the-burned-area"><i class="fa fa-check"></i><b>4.3.3</b> Forest fires subsets based on the size of the burned area</a></li>
<li class="chapter" data-level="4.3.4" data-path="kde.html"><a href="kde.html#ff-subsets-based-on-their-geographical-distribution"><i class="fa fa-check"></i><b>4.3.4</b> FF-subsets based on their geographical distribution</a></li>
<li class="chapter" data-level="4.3.5" data-path="kde.html"><a href="kde.html#extract-time-and-pts-object"><i class="fa fa-check"></i><b>4.3.5</b> Extract time and PTS object</a></li>
<li class="chapter" data-level="4.3.6" data-path="kde.html"><a href="kde.html#compute-the-st-k-function"><i class="fa fa-check"></i><b>4.3.6</b> Compute the ST K-function</a></li>
<li class="chapter" data-level="4.3.7" data-path="kde.html"><a href="kde.html#assess-the-st-clustering-behavior"><i class="fa fa-check"></i><b>4.3.7</b> Assess the ST clustering behavior</a></li>
<li class="chapter" data-level="4.3.8" data-path="kde.html"><a href="kde.html#compute-the-st-kernel-density-estimator"><i class="fa fa-check"></i><b>4.3.8</b> Compute the ST Kernel Density Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="kde.html"><a href="kde.html#conclusions-and-further-analyses-1"><i class="fa fa-check"></i><b>4.4</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="global-rf.html"><a href="global-rf.html"><i class="fa fa-check"></i><b>5</b> Predictive Mapping of Natural Hazards Using Random Forest</a>
<ul>
<li class="chapter" data-level="5.1" data-path="global-rf.html"><a href="global-rf.html#rf-for-landslides-susceptibility-mapping"><i class="fa fa-check"></i><b>5.1</b> RF for landslides susceptibility mapping</a></li>
<li class="chapter" data-level="5.2" data-path="global-rf.html"><a href="global-rf.html#computing-lab-random-forest"><i class="fa fa-check"></i><b>5.2</b> Computing lab: Random Forest</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="global-rf.html"><a href="global-rf.html#load-the-libraries-2"><i class="fa fa-check"></i><b>5.2.1</b> Load the libraries</a></li>
<li class="chapter" data-level="5.2.2" data-path="global-rf.html"><a href="global-rf.html#load-the-input-datasets"><i class="fa fa-check"></i><b>5.2.2</b> Load the input datasets</a></li>
<li class="chapter" data-level="5.2.3" data-path="global-rf.html"><a href="global-rf.html#the-use-of-categorical-variables-in-machine-learning"><i class="fa fa-check"></i><b>5.2.3</b> The use of categorical variables in Machine Learning</a></li>
<li class="chapter" data-level="5.2.4" data-path="global-rf.html"><a href="global-rf.html#extract-the-values"><i class="fa fa-check"></i><b>5.2.4</b> Extract the values</a></li>
<li class="chapter" data-level="5.2.5" data-path="global-rf.html"><a href="global-rf.html#split-the-input-dataset-into-training-and-testing"><i class="fa fa-check"></i><b>5.2.5</b> Split the input dataset into training and testing</a></li>
<li class="chapter" data-level="5.2.6" data-path="global-rf.html"><a href="global-rf.html#run-random-forest"><i class="fa fa-check"></i><b>5.2.6</b> Run Random Forest</a></li>
<li class="chapter" data-level="5.2.7" data-path="global-rf.html"><a href="global-rf.html#rf-main-outputs"><i class="fa fa-check"></i><b>5.2.7</b> RF main outputs</a></li>
<li class="chapter" data-level="5.2.8" data-path="global-rf.html"><a href="global-rf.html#model-evaluation"><i class="fa fa-check"></i><b>5.2.8</b> Model evaluation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="global-rf.html"><a href="global-rf.html#susceptibility-mapping"><i class="fa fa-check"></i><b>5.3</b> Susceptibility mapping</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="global-rf.html"><a href="global-rf.html#class-intervals-for-decision-maker"><i class="fa fa-check"></i><b>5.3.1</b> Class intervals for decision maker</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="global-rf.html"><a href="global-rf.html#conclusions-and-further-analyses-2"><i class="fa fa-check"></i><b>5.4</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="local-rf.html"><a href="local-rf.html"><i class="fa fa-check"></i><b>6</b> Interpretability &amp; Explainability with Random Forest</a>
<ul>
<li class="chapter" data-level="6.1" data-path="local-rf.html"><a href="local-rf.html#aim-of-the-present-lab"><i class="fa fa-check"></i><b>6.1</b> Aim of the present lab</a></li>
<li class="chapter" data-level="6.2" data-path="local-rf.html"><a href="local-rf.html#computing-lab-understanding-random-forest-models"><i class="fa fa-check"></i><b>6.2</b> Computing lab: Understanding Random Forest Models</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="local-rf.html"><a href="local-rf.html#re-load-libraries-and-workspace"><i class="fa fa-check"></i><b>6.2.1</b> Re-load libraries and workspace</a></li>
<li class="chapter" data-level="6.2.2" data-path="local-rf.html"><a href="local-rf.html#surrogate-model"><i class="fa fa-check"></i><b>6.2.2</b> Surrogate model</a></li>
<li class="chapter" data-level="6.2.3" data-path="local-rf.html"><a href="local-rf.html#features-importance-score"><i class="fa fa-check"></i><b>6.2.3</b> Features importance score</a></li>
<li class="chapter" data-level="6.2.4" data-path="local-rf.html"><a href="local-rf.html#partial-dependence-plot"><i class="fa fa-check"></i><b>6.2.4</b> Partial dependence plot</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="local-rf.html"><a href="local-rf.html#local-feature-importance"><i class="fa fa-check"></i><b>6.3</b> Local feature importance</a></li>
<li class="chapter" data-level="6.4" data-path="local-rf.html"><a href="local-rf.html#computing-lab-geographical-random-forest"><i class="fa fa-check"></i><b>6.4</b> Computing lab: Geographical Random Forest</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="local-rf.html"><a href="local-rf.html#global-variable-importance-plot"><i class="fa fa-check"></i><b>6.4.1</b> Global variable importance plot</a></li>
<li class="chapter" data-level="6.4.2" data-path="local-rf.html"><a href="local-rf.html#local-feature-importance-mapping"><i class="fa fa-check"></i><b>6.4.2</b> Local feature importance mapping</a></li>
<li class="chapter" data-level="6.4.3" data-path="local-rf.html"><a href="local-rf.html#local-r-squared"><i class="fa fa-check"></i><b>6.4.3</b> Local R squared</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="local-rf.html"><a href="local-rf.html#conclusions-and-further-analyses-3"><i class="fa fa-check"></i><b>6.5</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="som.html"><a href="som.html"><i class="fa fa-check"></i><b>7</b> Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach</a>
<ul>
<li class="chapter" data-level="7.1" data-path="som.html"><a href="som.html#geo-demographic-context-in-switzerland"><i class="fa fa-check"></i><b>7.1</b> Geo-demographic context in Switzerland</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="som.html"><a href="som.html#swiss-census-data"><i class="fa fa-check"></i><b>7.1.1</b> Swiss census data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="som.html"><a href="som.html#self-organizing-map"><i class="fa fa-check"></i><b>7.2</b> Self Organizing Map</a></li>
<li class="chapter" data-level="7.3" data-path="som.html"><a href="som.html#computing-lab-som"><i class="fa fa-check"></i><b>7.3</b> Computing lab: SOM</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="som.html"><a href="som.html#load-the-libraries-3"><i class="fa fa-check"></i><b>7.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="7.3.2" data-path="som.html"><a href="som.html#import-the-swiss-census-dataset"><i class="fa fa-check"></i><b>7.3.2</b> Import the Swiss census dataset</a></li>
<li class="chapter" data-level="7.3.3" data-path="som.html"><a href="som.html#run-som"><i class="fa fa-check"></i><b>7.3.3</b> Run SOM</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="som.html"><a href="som.html#hierarchical-clustering"><i class="fa fa-check"></i><b>7.4</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="som.html"><a href="som.html#map-clusters-onto-the-geographical-space"><i class="fa fa-check"></i><b>7.4.1</b> <strong>Map clusters onto the geographical space</strong></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="som.html"><a href="som.html#clusters-characterization"><i class="fa fa-check"></i><b>7.5</b> Clusters characterization</a></li>
<li class="chapter" data-level="7.6" data-path="som.html"><a href="som.html#conclusions"><i class="fa fa-check"></i><b>7.6</b> Conclusions</a></li>
<li class="chapter" data-level="7.7" data-path="som.html"><a href="som.html#further-analyses"><i class="fa fa-check"></i><b>7.7</b> Further analyses</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="dbscan.html"><a href="dbscan.html"><i class="fa fa-check"></i><b>8</b> DBSCAN for 3D features detection in geosciences</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dbscan.html"><a href="dbscan.html#the-overall-methodology-1"><i class="fa fa-check"></i><b>8.1</b> The overall methodology</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dbscan.html"><a href="dbscan.html#dbscan-3-d-density-based-clustering-algorithm"><i class="fa fa-check"></i><b>8.1.1</b> DBSCAN: 3-D density based clustering algorithm</a></li>
<li class="chapter" data-level="8.1.2" data-path="dbscan.html"><a href="dbscan.html#field-campaign"><i class="fa fa-check"></i><b>8.1.2</b> Field campaign</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="dbscan.html"><a href="dbscan.html#computing-lab-dbscan"><i class="fa fa-check"></i><b>8.2</b> Computing lab: DBSCAN</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="dbscan.html"><a href="dbscan.html#load-the-libraries-4"><i class="fa fa-check"></i><b>8.2.1</b> Load the libraries</a></li>
<li class="chapter" data-level="8.2.2" data-path="dbscan.html"><a href="dbscan.html#import-and-visualize-the-point-clouds-dataset"><i class="fa fa-check"></i><b>8.2.2</b> Import and visualize the point clouds dataset</a></li>
<li class="chapter" data-level="8.2.3" data-path="dbscan.html"><a href="dbscan.html#compute-dbscan"><i class="fa fa-check"></i><b>8.2.3</b> Compute DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="dbscan.html"><a href="dbscan.html#conclusions-and-further-analyses-4"><i class="fa fa-check"></i><b>8.3</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Geospatial Data Analysis with R – Applications in Geosciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geodata" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Basic operations with geodata in R<a href="geodata.html#geodata" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction<a href="geodata.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Geodata, or geospatial data, refers to features associated with a specific location on the Earth’s surface. Geodata can be in various forms and is often used in Geographic Information Systems (GIS) for mapping and analysis. The two key components characterizing geodata are the <strong>spatial component</strong> and <strong>attributes</strong>. The spatial component specifies the location and shape of the features, with different levels of detail, while attributes describe their characteristics.</p>
<p>The two basic formats used to represent the spatial component of geodata are:</p>
<ol style="list-style-type: decimal">
<li><strong>Vector</strong>: this format uses points, lines, and polygons to identify each individual features.</li>
<li><strong>Raster</strong>: this format uses a regular grid of pixels to represent the global geographic context.</li>
</ol>
<p>In addition, <strong>attribute tables</strong> are used to store the characteristics associated with the geospatial features.</p>
<p>The GIS software are specifically designed to help user to edit, manage, analyze, and map geodata. To make working with geodata easier, several packages have been developed in R. These packages allow users to handle geodata directly in R computing environment, without needing separate GIS software.</p>
<p>In this chapter, we introduce the basic functions allowing to work with geodata in the pre-processing and post-processing phase of a pipeline in geomodeling.</p>
</div>
<div id="plotting-vector-dataset" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Plotting vector dataset<a href="geodata.html#plotting-vector-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The spatial component of geodata uses geometric primitives like point, line, and polygon to represent the single features. Each feature in a geodataset is associated with various attributes providing detailed quantitative and qualitative information. A single geodataset includes features of the same type, represented by using the same class of primitive.</p>
<p>The three basic <strong>geometric vector primitives</strong> have the following characteristics:</p>
<ul>
<li><em>Points</em>: defined by a single pair of coordinates (x, y) representing a specific location. Used to represent small objects like weather stations, city center, or to identify single features in a geo-hazard inventory (e.g., earthquake’s epicenter, landslides location, wildfires, etc.).</li>
<li><em>Lines</em>: defined by pairs of coordinates connected to each other, representing linear features such as roads or rivers network, pathways, railway, etc.</li>
<li><em>Polygons</em>: defined by a series of connected coordinates that enclose an area, representing features such as lakes, administrative units, vegetation patches, burned area, landslides footprint.</li>
</ul>
<div id="package-sf-for-vector-dataset" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Package <strong><em>sf</em></strong> for vector dataset<a href="geodata.html#package-sf-for-vector-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The package <strong>sf</strong> <span class="citation">(<a href="#ref-Pebesma_2023">Pebesma and Bivand 2023</a>; <a href="#ref-Pebesma_2018">Pebesma 2018</a>)</span> has been designed to work with vector data as “simple features” in R. Each feature is represented by one row in the data frame, with attributes stored as columns and spatial information stored in a special geometry column.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="geodata.html#cb48-1" tabindex="-1"></a><span class="co"># Load the library sf </span></span>
<span id="cb48-2"><a href="geodata.html#cb48-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<p>As a toy example, we will work with the geodataset of administrative boundaries in the Canton of Vaud (Switzerland). This dataset is available in shapefile format, one of the most widely used file formats for vector geospatial data. The field “Munics” represents the municipalities.</p>
<p>A <strong>shapefile</strong> includes multiple files allowing to store different kind of objects:</p>
<ul>
<li><em>*shp</em>: the features’ geometries (i.e., the geometric vector primitive used to describe the features).</li>
<li><em>*dbf</em>: the attributes, describing the characteristics of the features (i.e., tabular information).</li>
<li><em>*shx</em>: shape index format, an index file for the geometry data.</li>
<li><em>*prj</em>: the coordinate reference systems, defining how the geometries are projected on the Earth’s surface.</li>
</ul>
<p>To read a shapefile, you only need to specify the file name with “.shp” extension. However, it is important to have all related files in the same directory to ensures that the shapefile is read correctly and all necessary information is available for the analysis.</p>
<p>Shapefiles can be imported and converted as sf-objects using the command <code>st_read()</code>. By setting the argument <code>quiet = FALSE</code> suppresses the output from the console when importing geodata.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="geodata.html#cb49-1" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb49-2"><a href="geodata.html#cb49-2" tabindex="-1"></a>vaud <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/RGIS/Vaud.shp&quot;</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Reading layer `Vaud&#39; from data source `C:\AGDA_Rbook\data\RGIS\Vaud.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 315 features and 4 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 2494306 ymin: 1115149 xmax: 2585462 ymax: 1203493
## Projected CRS: CH1903+ / LV95</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="geodata.html#cb51-1" tabindex="-1"></a><span class="co"># Inspect the attribute table </span></span>
<span id="cb51-2"><a href="geodata.html#cb51-2" tabindex="-1"></a><span class="fu">str</span>(vaud)</span></code></pre></div>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   315 obs. of  5 variables:
##  $ Shape_Leng: num  30547 21405 27147 31111 28268 ...
##  $ Shape_Area: num  24178457 23354685 23190781 22858943 22501915 ...
##  $ Munics    : chr  &quot;Payerne&quot; &quot;Rossinière&quot; &quot;Vallorbe&quot; &quot;Puidoux&quot; ...
##  $ Code      : chr  &quot;5822&quot; &quot;5842&quot; &quot;5764&quot; &quot;5607&quot; ...
##  $ geometry  :sfc_POLYGON of length 315; first list element: List of 1
##   ..$ : num [1:783, 1:2] 2559434 2559258 2559286 2559263 2559337 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;POLYGON&quot; &quot;sfg&quot;
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA
##   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Shape_Leng&quot; &quot;Shape_Area&quot; &quot;Munics&quot; &quot;Code&quot;</code></pre>
</div>
<div id="plot-vector-features" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Plot vector features<a href="geodata.html#plot-vector-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Basic maps can be created with the command <code>plot()</code>. By default this creates a multi-panel plot: one plot for each variable included in the geodata (corresponding to each column). Otherwise, you can specify the name of variable that you wish to display.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="geodata.html#cb53-1" tabindex="-1"></a><span class="co"># Basic plot (diplay all the variables)</span></span>
<span id="cb53-2"><a href="geodata.html#cb53-2" tabindex="-1"></a><span class="fu">plot</span>(vaud) </span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/simple-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="geodata.html#cb54-1" tabindex="-1"></a><span class="co"># Display each municipality using single color (attributed randomly)</span></span>
<span id="cb54-2"><a href="geodata.html#cb54-2" tabindex="-1"></a><span class="fu">plot</span>(vaud[<span class="st">&quot;Munics&quot;</span>], <span class="at">main=</span><span class="st">&quot;Municipal boundaries&quot;</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/simple-plot-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>A legend with a continuous color scale is produced by default if the object to be plotted is numeric.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="geodata.html#cb55-1" tabindex="-1"></a><span class="co"># Plot based on the value &quot;area&quot; </span></span>
<span id="cb55-2"><a href="geodata.html#cb55-2" tabindex="-1"></a><span class="fu">plot</span>(vaud[<span class="st">&quot;Shape_Area&quot;</span>], <span class="at">reset =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/plot-area-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Different operations can be performed to customize the map. For instance, you can highlight the municipality of Lausanne in red to show its geographic correspondence, keeping all the other municipalities grey.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="geodata.html#cb56-1" tabindex="-1"></a><span class="co"># Extract the boundary of Lausanne</span></span>
<span id="cb56-2"><a href="geodata.html#cb56-2" tabindex="-1"></a>Lausanne <span class="ot">=</span> <span class="fu">st_union</span>(vaud[vaud<span class="sc">$</span>Munics <span class="sc">==</span> <span class="st">&quot;Lausanne&quot;</span>, ])</span>
<span id="cb56-3"><a href="geodata.html#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="geodata.html#cb56-4" tabindex="-1"></a><span class="co"># Plot the Lausanne municipal boundaries over the map of Canton of Vaud</span></span>
<span id="cb56-5"><a href="geodata.html#cb56-5" tabindex="-1"></a><span class="fu">plot</span>(vaud[<span class="st">&quot;Munics&quot;</span>],<span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">reset =</span> <span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">&quot;Canton Vaud, Lausanne&quot;</span>)</span>
<span id="cb56-6"><a href="geodata.html#cb56-6" tabindex="-1"></a><span class="fu">plot</span>(Lausanne, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/plot-Lausanne-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="plotting-raster-dataset" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Plotting raster dataset<a href="geodata.html#plotting-raster-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Raster data are different from vector data in that they are referenced to a regular grid of regular (usually square) cells, called pixels. The spatial characteristics of a raster dataset are defined by its spatial resolution (the height and width of each cell) and its origin (typically the upper left corner of the raster grid, which is associated with a location in a coordinate reference system).</p>
<p>Raster data is highly effective for modeling and visualizing continuous spatial phenomena such as elevation, temperature, and precipitation. Each cell in the grid captures a value representing the attribute at that specific location, allowing for smooth and detailed gradients across the study area. This format is also effective in representing categorical variables such as land cover, where each cell is associated with a class value.</p>
<p>Common <strong>raster formats</strong> used for spatial analyses include:</p>
<ol style="list-style-type: decimal">
<li><em>GeoTIFF (*.tif, *.tiff):</em>
<ul>
<li>A widely used format that includes geographic metadata such as coordinates and projection information, making it easy to integrate with GIS applications.</li>
</ul></li>
<li><em>ESRI Grid:</em>
<ul>
<li>A proprietary format developed by ESRI for use with its software, such as ArcGIS. It supports both integer and floating-point grids.</li>
</ul></li>
<li><em>Erdas Imagine (*.img):</em>
<ul>
<li>A format developed by ERDAS for its Imagine software, often used for remote sensing data and satellite imagery. It supports large files and multiple bands.</li>
</ul></li>
<li><em>NetCDF (*.nc):</em>
<ul>
<li>Stands for Network Common Data Form, used for array-oriented scientific data, including GIS data. It supports multidimensional data arrays, making it suitable for complex environmental and atmospheric data.</li>
</ul></li>
<li><em>Hierarchical Data Format (HDF):</em>
<ul>
<li>Similar to NetCDF, HDF is used for managing and storing large amounts of data, especially in scientific computing. It supports various data types and is used for satellite imagery and climate data.</li>
</ul></li>
<li><em>ASCII Grid (*.asc):</em>
<ul>
<li>A simple, text-based raster format where each cell value is represented by a number in a grid layout. It’s easy to read and edit with a text editor.</li>
</ul></li>
</ol>
<p>These formats vary in terms of compression, metadata support, and suitability for different types of raster data, from simple images to complex scientific datasets.</p>
<div id="terra-package-and-raster-dataset" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Terra package and raster dataset<a href="geodata.html#terra-package-and-raster-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The package <strong>terra</strong> provides a variety of specialized classes and functions for importing, processing, analyzing, and visualizing raster datasets <span class="citation">(<a href="#ref-Hijmans_2024">Hijmans 2024</a>)</span>. It is intended to replace the package “raster”, which has similar data objects and the function syntax as terra package. However, the terra package contains several major improvements, including faster processing speed for large raster.</p>
</div>
<div id="plot-raster-features" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Plot raster features<a href="geodata.html#plot-raster-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Raster objects can be imported using the function <code>rast()</code> and exported using <code>writeRaster()</code>, specifying the format argument. As a toy example, we will work with the raster *.tif representing the digital elevation model (DEM) of Canton Vaud. Similar to the sf package for plotting vector data, terra also provides <code>plot()</code> methods for its own classes.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="geodata.html#cb57-1" tabindex="-1"></a><span class="co"># Load the library terra </span></span>
<span id="cb57-2"><a href="geodata.html#cb57-2" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb57-3"><a href="geodata.html#cb57-3" tabindex="-1"></a></span>
<span id="cb57-4"><a href="geodata.html#cb57-4" tabindex="-1"></a><span class="co"># Load the raster dataset</span></span>
<span id="cb57-5"><a href="geodata.html#cb57-5" tabindex="-1"></a>DEM_VD <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/RGIS/DEM100.tif&quot;</span>)</span>
<span id="cb57-6"><a href="geodata.html#cb57-6" tabindex="-1"></a></span>
<span id="cb57-7"><a href="geodata.html#cb57-7" tabindex="-1"></a><span class="co"># Inspect the raster</span></span>
<span id="cb57-8"><a href="geodata.html#cb57-8" tabindex="-1"></a>DEM_VD</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 881, 912, 1  (nrow, ncol, nlyr)
## resolution  : 100, 100  (x, y)
## extent      : 494300, 585500, 115150, 203250  (xmin, xmax, ymin, ymax)
## coord. ref. : CH1903 / LV03 (EPSG:21781) 
## source      : DEM100.tif 
## name        : DEM100 
## min value   :  372.0 
## max value   : 3193.2</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="geodata.html#cb59-1" tabindex="-1"></a><span class="co"># Plot raster dataset</span></span>
<span id="cb59-2"><a href="geodata.html#cb59-2" tabindex="-1"></a><span class="fu">plot</span>(DEM_VD, <span class="at">main=</span><span class="st">&quot;DEM&quot;</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/plot-raster-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="geodata-manipulation" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Geodata manipulation<a href="geodata.html#geodata-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we explore some basic manipulations with vector and raster geodata. This will be useful in the following chapters of this book.</p>
<div id="manipulate-tabular-datasets" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Manipulate tabular datasets<a href="geodata.html#manipulate-tabular-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a vector dataset, the characteristics associated with geospatial features are stored in the attribute table. Each feature in the vector dataset is linked to a row in the table, with its characteristics organized into columns. Columns, also known as fields, store the various attributes associated with the features.</p>
<p>Thematic attributes stored in separate tabular dataset (such as census data, environmental monitoring stations, public health, or traffic data) can be imported and added to the attribute table of a given vector datased if the two dataset are referred to the same spatial features.</p>
<p>While tabular dataset can be delivered in different format (such as *.dbf, *.xlsx, *.txt), the most widely used format is *<strong>.csv</strong> (comma-separated values). As for other tabular format, *.csv is structured into rows and columns, where each column is separated by a comma. The first row often contains the column headers (field names), which describes the attribute in each column. The main advantages of this format compared with other formats are:</p>
<ul>
<li><em>Simplicity</em>: easy to create, read, and edit.</li>
<li><em>Lightweight</em>: files are typically small and easy to transfer.</li>
<li><em>Compatibility</em>: supported by most data processing tools and software.</li>
</ul>
<p>In most cases, data need to be reworked before beeing visualized and analyzed in R. Common tasks include: selecting subsets of rows or columns from the attribute table, rename a field, calculate new variables from the raw data values, compute summary statistics, combine data from different sources. To this end, the package <strong>dplyr</strong> <span class="citation">(<a href="#ref-Wickham_et_al_2003">Wickham et al. 2023</a>)</span> provides consistent set of functions that help you to solve the most common data manipulation challenges. We explore some of them in the following code chunks.</p>
<p>As a toy example, we will work with the the Swioss population census dataset 2020.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="geodata.html#cb60-1" tabindex="-1"></a><span class="co"># Load ths library dply</span></span>
<span id="cb60-2"><a href="geodata.html#cb60-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-3"><a href="geodata.html#cb60-3" tabindex="-1"></a></span>
<span id="cb60-4"><a href="geodata.html#cb60-4" tabindex="-1"></a><span class="co"># Load tabular dataset</span></span>
<span id="cb60-5"><a href="geodata.html#cb60-5" tabindex="-1"></a>Swisscensus_2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/RGIS/census2020.csv&quot;</span>)</span>
<span id="cb60-6"><a href="geodata.html#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="geodata.html#cb60-7" tabindex="-1"></a><span class="co"># Inspect the element </span></span>
<span id="cb60-8"><a href="geodata.html#cb60-8" tabindex="-1"></a><span class="fu">str</span>(Swisscensus_2020)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2145 obs. of  35 variables:
##  $ ID_0                 : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ ID                   : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ p_infrastructure     : num  0.131 0.302 0.178 0.133 0.199 ...
##  $ p_forested           : num  0.307 0.28 0.287 0.291 0.332 ...
##  $ p_agriculture        : num  0.502 0.401 0.526 0.554 0.464 ...
##  $ p_improductible      : num  0.05815 0.01133 0.01077 0.025 0.00766 ...
##  $ surface_polygone     : num  791 1059 743 1360 653 ...
##  $ natural_growth_1000  : num  -1.001 2.115 4.65 2.119 0.528 ...
##  $ density              : num  255 1160 755 279 581 ...
##  $ dependency_ratio     : num  60.1 63.4 68.6 67.4 62.9 ...
##  $ migration_intern     : num  11.014 -6.1 -0.537 9.534 -2.905 ...
##  $ migration            : num  3.5 5.61 1.07 1.32 5.02 ...
##  $ p_employment         : num  0.105 0.415 0.109 0.14 0.364 ...
##  $ primary_sector       : num  0.19388 0.06495 0 2.12 0.00187 ...
##  $ secondary_sector     : num  0.148 1.724 0 2.8 0.045 ...
##  $ tertiary_sector      : num  1.9898 7.6414 0.3155 16.1 0.0569 ...
##  $ p_social_assistance  : num  1.31 3.19 1.13 1.25 1.27 ...
##  $ p_new_buildings      : num  1.514 0.732 0.179 0.8 0.529 ...
##  $ p_new_housings       : num  5.048 4.552 0.179 1.333 1.059 ...
##  $ p_cinema             : num  0 0.0195 0 0 0 ...
##  $ p_museum             : num  0.000993 0 0 0 0.000264 ...
##  $ p_culture_institution: num  0.01142 0.00667 0.00588 0.00816 0.00606 ...
##  $ size_households      : num  2.28 2.19 2.37 2.39 2.38 ...
##  $ p_new_entreprise     : num  0.00497 0.00407 0.00267 0.00421 0.00369 ...
##  $ p_weddings           : num  2.5 4.8 4.65 2.65 1.85 ...
##  $ p_foreigners         : num  14.4 29 17.3 15.8 17.4 ...
##  $ p_individual_houses  : num  69.2 54.7 71.6 69.1 74.7 ...
##  $ Population           : num  2014 12289 5610 3801 3795 ...
##  $ p_pop_19             : num  19.8 22.3 21.9 22.1 19.3 ...
##  $ p_pop_65             : num  18.5 18.6 14.1 21.5 20.4 ...
##  $ lat                  : num  0.571 0.562 0.566 0.582 0.562 ...
##  $ long                 : num  0.735 0.738 0.756 0.719 0.748 ...
##  $ zab_2022             : num  69.6 285.9 92.4 126.6 102.8 ...
##  $ net_income_h         : num  57603 36521 45237 45791 48875 ...
##  $ p_transport          : num  5.06 7.69 5.11 4.55 4.89 ...</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="geodata.html#cb62-1" tabindex="-1"></a><span class="co"># Create a subset including only Land Use information</span></span>
<span id="cb62-2"><a href="geodata.html#cb62-2" tabindex="-1"></a>Swisscensus2020_LU <span class="ot">=</span> <span class="fu">subset</span>(Swisscensus_2020, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb62-3"><a href="geodata.html#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="geodata.html#cb62-4" tabindex="-1"></a><span class="fu">str</span>(Swisscensus2020_LU)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2145 obs. of  5 variables:
##  $ ID              : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ p_infrastructure: num  0.131 0.302 0.178 0.133 0.199 ...
##  $ p_forested      : num  0.307 0.28 0.287 0.291 0.332 ...
##  $ p_agriculture   : num  0.502 0.401 0.526 0.554 0.464 ...
##  $ p_improductible : num  0.05815 0.01133 0.01077 0.025 0.00766 ...</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="geodata.html#cb64-1" tabindex="-1"></a><span class="co"># Rename a column for better understanding</span></span>
<span id="cb64-2"><a href="geodata.html#cb64-2" tabindex="-1"></a>CH2020_LU <span class="ot">&lt;-</span> <span class="fu">rename</span>(Swisscensus2020_LU, <span class="at">Urban=</span>p_infrastructure)</span>
<span id="cb64-3"><a href="geodata.html#cb64-3" tabindex="-1"></a><span class="fu">head</span>(CH2020_LU)</span></code></pre></div>
<pre><code>##   ID      Urban p_forested p_agriculture p_improductible
## 1  1 0.13147914  0.3072061     0.5018963     0.058154235
## 2  2 0.30217186  0.2804533     0.4013220     0.011331445
## 3  3 0.17765814  0.2866756     0.5262450     0.010767160
## 4  4 0.13308823  0.2911765     0.5536765     0.025000000
## 5  5 0.19908116  0.3323124     0.4640123     0.007656968
## 6  6 0.08712121  0.2058081     0.6830808     0.011363636</code></pre>
</div>
<div id="pipes-chaining-of-multiple-operations" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Pipes: chaining of multiple operations<a href="geodata.html#pipes-chaining-of-multiple-operations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pipes allow for the chaining of multiple operations in a unique sequence, which makes the code easier to understand and reduces the need for nested function calls.</p>
<p>The use of pipes in R, primarily facilitated by the <strong>magrittr</strong> package and now natively supported in base R (R version 4.1.0 and above), is a powerful way to write clear and readable code. The function pipe is represented by the symbol <code>%&gt;%</code>. When a pipe is placed on the right side of an object or function, the output from the function is passed as the first argument to the next function after the pipe.</p>
<p>Below is a simple example of using the pipe operator with the function <code>select()</code>, used to select the the fields related to the land use in the Swiss census dataset corresponding to a population density less than 100.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="geodata.html#cb66-1" tabindex="-1"></a>LU_dens100 <span class="ot">&lt;-</span> </span>
<span id="cb66-2"><a href="geodata.html#cb66-2" tabindex="-1"></a>  Swisscensus_2020 <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="geodata.html#cb66-3" tabindex="-1"></a>  <span class="fu">filter</span>(density <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="geodata.html#cb66-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb66-5"><a href="geodata.html#cb66-5" tabindex="-1"></a></span>
<span id="cb66-6"><a href="geodata.html#cb66-6" tabindex="-1"></a><span class="fu">str</span>(LU_dens100)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    660 obs. of  5 variables:
##  $ ID              : int  23 81 114 182 211 226 309 322 325 326 ...
##  $ p_infrastructure: num  0.0514 0.0635 0.0483 0.0785 0.0727 ...
##  $ p_forested      : num  0.455 0.453 0.614 0.366 0.203 ...
##  $ p_agriculture   : num  0.479 0.487 0.32 0.521 0.683 ...
##  $ p_improductible : num  0.01712 0.00219 0.01521 0.03217 0.04156 ...</code></pre>
</div>
<div id="join-table" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Join table<a href="geodata.html#join-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A tabular dataset can be joined to the attribute table of a vector dataset by specifying the name of the columns in the two tables used for merging. To this end, we can use the function <code>merge()</code> included in the package sp .</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="geodata.html#cb68-1" tabindex="-1"></a>Vaud_census_2020 <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x=</span>vaud, <span class="at">y=</span>Swisscensus_2020,</span>
<span id="cb68-2"><a href="geodata.html#cb68-2" tabindex="-1"></a>                             <span class="at">by.x=</span><span class="st">&quot;Code&quot;</span>, </span>
<span id="cb68-3"><a href="geodata.html#cb68-3" tabindex="-1"></a>                             <span class="at">by.y=</span><span class="st">&quot;ID&quot;</span>,</span>
<span id="cb68-4"><a href="geodata.html#cb68-4" tabindex="-1"></a>                             <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb68-5"><a href="geodata.html#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="geodata.html#cb68-6" tabindex="-1"></a><span class="co"># Plot based on a joined attribute</span></span>
<span id="cb68-7"><a href="geodata.html#cb68-7" tabindex="-1"></a><span class="fu">plot</span>(Vaud_census_2020[<span class="st">&quot;p_agriculture&quot;</span>])</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/merge-tab-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="mapping-with-ggplot2" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Mapping with ggplot2<a href="geodata.html#mapping-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mapping in R can be efficiently achieved using the powerful visualization package <strong>ggplot2</strong>, especially when combined with additional packages like sf. These tools togheter enable users to create detailed and customized maps for spatial data analysis and visualization. In particular sf facilitates the handling of complex spatial data structures, making it possible to create intricate and informative maps.</p>
<p>In the following example we crate an aesthetic map of Canton Vaud based on the percentage of agricultural land use by municipality. Aesthetic mappings describe how the attributes of the geodata are mapped to the visual properties (aesthetics) of the plot. The command aesthetics – <code>aes()</code> – control the appearance of the plot elements, such as points, lines, bars, and so on.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="geodata.html#cb69-1" tabindex="-1"></a><span class="co"># load the library gglpt2</span></span>
<span id="cb69-2"><a href="geodata.html#cb69-2" tabindex="-1"></a><span class="fu">library</span> (ggplot2)</span>
<span id="cb69-3"><a href="geodata.html#cb69-3" tabindex="-1"></a></span>
<span id="cb69-4"><a href="geodata.html#cb69-4" tabindex="-1"></a><span class="co"># Install viridis color scale as a package </span></span>
<span id="cb69-5"><a href="geodata.html#cb69-5" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;viridis&quot;</span>, <span class="at">repos=</span><span class="st">&quot;http://cran.us.r-project.org&quot;</span>)</span></code></pre></div>
<pre><code>## package &#39;viridis&#39; successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
##  C:\Users\mtonini1\AppData\Local\Temp\RtmpKcdoL5\downloaded_packages</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="geodata.html#cb71-1" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb71-2"><a href="geodata.html#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="geodata.html#cb71-3" tabindex="-1"></a><span class="co"># Use ggplot2 for mapping</span></span>
<span id="cb71-4"><a href="geodata.html#cb71-4" tabindex="-1"></a><span class="fu">ggplot</span>(Vaud_census_2020) <span class="sc">+</span></span>
<span id="cb71-5"><a href="geodata.html#cb71-5" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> p_agriculture)) <span class="sc">+</span></span>
<span id="cb71-6"><a href="geodata.html#cb71-6" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Agri (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-7"><a href="geodata.html#cb71-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-8"><a href="geodata.html#cb71-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Agrucultural land use&quot;</span>,</span>
<span id="cb71-9"><a href="geodata.html#cb71-9" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Canton vaud - census 2020&quot;</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/mapping-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cropping-ratser" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Cropping ratser<a href="geodata.html#cropping-ratser" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many projects in geosciences require integrating raster data covering an exension larger than the study area. In these scenarios, raster cropping and masking are essential for standardizing the spatial extent of the input data. These operations help to minimize memory usage and computational resources needed for subsequent analysis, and often represnet a crucial pre-processing step before generating detailed and visually appealing maps incorporating raster data.</p>
<p>The first check you need to perform when importing data from different sources is to verify whether the <strong>coordinate reference systems (CRS)</strong> of the input geodatasets are consistent. To this end, simply type the names of the geodatasets and check the “coord. ref.” attribute. For a detailed description of the coordinate reference system, use the <code>crs()</code> function. If necessary, re-project one of the spatial layers using the <code>project()</code> function, specifying the CRS of the other dataset to ensure their extents perfectly overlap.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="geodata.html#cb72-1" tabindex="-1"></a><span class="co"># Verify CRS</span></span>
<span id="cb72-2"><a href="geodata.html#cb72-2" tabindex="-1"></a>DEM_VD</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 881, 912, 1  (nrow, ncol, nlyr)
## resolution  : 100, 100  (x, y)
## extent      : 494300, 585500, 115150, 203250  (xmin, xmax, ymin, ymax)
## coord. ref. : CH1903 / LV03 (EPSG:21781) 
## source      : DEM100.tif 
## name        : DEM100 
## min value   :  372.0 
## max value   : 3193.2</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="geodata.html#cb74-1" tabindex="-1"></a>vaud</span></code></pre></div>
<pre><code>## Simple feature collection with 315 features and 4 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 2494306 ymin: 1115149 xmax: 2585462 ymax: 1203493
## Projected CRS: CH1903+ / LV95
## First 10 features:
##    Shape_Leng Shape_Area         Munics Code                       geometry
## 1    30546.68   24178457        Payerne 5822 POLYGON ((2559434 1183900, ...
## 2    21404.88   23354685     Rossinière 5842 POLYGON ((2568027 1143632, ...
## 3    27146.69   23190781       Vallorbe 5764 POLYGON ((2519472 1176171, ...
## 4    31110.58   22858943        Puidoux 5607 POLYGON ((2551941 1152936, ...
## 5    28268.14   22501915        Baulmes 5745 POLYGON ((2524665 1180813, ...
## 6    26122.21   22002176     Corbeyrier 5404 POLYGON ((2565278 1132847, ...
## 7    33182.64   20915807 Vully-les-Lacs 5464 POLYGON ((2565363 1195281, ...
## 8    29224.24   20772714        Bassins 5703 POLYGON ((2508540 1146203, ...
## 9    20254.18   19791177  Mont-la-Ville 5491 POLYGON ((2519784 1169416, ...
## 10   30004.81   19487486       Avenches 5451 POLYGON ((2570746 1194939, ...</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="geodata.html#cb76-1" tabindex="-1"></a><span class="co"># Project the DEM data using the CRS of the shapefile </span></span>
<span id="cb76-2"><a href="geodata.html#cb76-2" tabindex="-1"></a>demVD_prj <span class="ot">=</span> <span class="fu">project</span>(DEM_VD, <span class="fu">crs</span>(vaud))</span>
<span id="cb76-3"><a href="geodata.html#cb76-3" tabindex="-1"></a></span>
<span id="cb76-4"><a href="geodata.html#cb76-4" tabindex="-1"></a><span class="co"># Verify again</span></span>
<span id="cb76-5"><a href="geodata.html#cb76-5" tabindex="-1"></a><span class="fu">plot</span>(DEM_VD)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/project-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="geodata.html#cb77-1" tabindex="-1"></a><span class="fu">plot</span>(demVD_prj)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/project-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="geodata.html#cb78-1" tabindex="-1"></a><span class="co"># Extract the municipality of Lausanne</span></span>
<span id="cb78-2"><a href="geodata.html#cb78-2" tabindex="-1"></a>Lausanne <span class="ot">&lt;-</span> <span class="fu">filter</span>(vaud, Munics <span class="sc">==</span> <span class="st">&quot;Lausanne&quot;</span>)</span>
<span id="cb78-3"><a href="geodata.html#cb78-3" tabindex="-1"></a></span>
<span id="cb78-4"><a href="geodata.html#cb78-4" tabindex="-1"></a><span class="co"># Crop the DEM to the extent of Lausanne (bounding box)</span></span>
<span id="cb78-5"><a href="geodata.html#cb78-5" tabindex="-1"></a>DEM_Lausanne_cropped <span class="ot">&lt;-</span> <span class="fu">crop</span>(demVD_prj, Lausanne)</span>
<span id="cb78-6"><a href="geodata.html#cb78-6" tabindex="-1"></a></span>
<span id="cb78-7"><a href="geodata.html#cb78-7" tabindex="-1"></a><span class="co"># Mask the cropped DEM using the Lausanne polygon to get the exact shape</span></span>
<span id="cb78-8"><a href="geodata.html#cb78-8" tabindex="-1"></a>DEM_Lausanne <span class="ot">&lt;-</span> <span class="fu">mask</span>(DEM_Lausanne_cropped, Lausanne)</span>
<span id="cb78-9"><a href="geodata.html#cb78-9" tabindex="-1"></a></span>
<span id="cb78-10"><a href="geodata.html#cb78-10" tabindex="-1"></a><span class="co"># Plot the DEM</span></span>
<span id="cb78-11"><a href="geodata.html#cb78-11" tabindex="-1"></a><span class="fu">plot</span>(DEM_Lausanne, <span class="at">main =</span> <span class="st">&quot;DEM of Lausanne&quot;</span>)</span>
<span id="cb78-12"><a href="geodata.html#cb78-12" tabindex="-1"></a></span>
<span id="cb78-13"><a href="geodata.html#cb78-13" tabindex="-1"></a><span class="co"># Add the Lausanne polygon outline</span></span>
<span id="cb78-14"><a href="geodata.html#cb78-14" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(Lausanne), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">border =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/cropping-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="display-the-categorical-variables-of-a-raster" class="section level3 hasAnchor" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Display the categorical variables of a raster<a href="geodata.html#display-the-categorical-variables-of-a-raster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Categorical variables, also known as qualitative variables, are variables that represent distinct groups or categories. These variables are typically non-numeric and can be divided into a finite number of categories or levels. Categorical variables are often used to represent characteristics or attributes that do not have a natural ordering.</p>
<p>Land use classes of a raster dataset are a common example of categorical variables. Each class represents a distinct type of land use labeled with names or, mostly, numeric codes.</p>
<p>To understand the characteristics of the categorical variables, you can plot the “Land Cover” raster dataset by using its original classes. To visualize the data you need to perform few data manipulations before.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="geodata.html#cb79-1" tabindex="-1"></a><span class="co"># Load the raster data</span></span>
<span id="cb79-2"><a href="geodata.html#cb79-2" tabindex="-1"></a>landCover <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/RGIS/landCover.tif&quot;</span>)</span>
<span id="cb79-3"><a href="geodata.html#cb79-3" tabindex="-1"></a></span>
<span id="cb79-4"><a href="geodata.html#cb79-4" tabindex="-1"></a><span class="co"># Inspect the raster</span></span>
<span id="cb79-5"><a href="geodata.html#cb79-5" tabindex="-1"></a>landCover</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 3524, 3647, 1  (nrow, ncol, nlyr)
## resolution  : 25, 25  (x, y)
## extent      : 494300, 585475, 115150, 203250  (xmin, xmax, ymin, ymax)
## coord. ref. : CH1903 / LV03 (EPSG:21781) 
## source      : landCover.tif 
## name        : landCover 
## min value   :        11 
## max value   :        62</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="geodata.html#cb81-1" tabindex="-1"></a><span class="co"># Plot the raster (using codes)</span></span>
<span id="cb81-2"><a href="geodata.html#cb81-2" tabindex="-1"></a><span class="fu">plot</span> (landCover)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/landCover-map-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="geodata.html#cb82-1" tabindex="-1"></a><span class="co"># Convert the raster as a factor to represent categorical data</span></span>
<span id="cb82-2"><a href="geodata.html#cb82-2" tabindex="-1"></a>landCover <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">rast</span>(<span class="st">&quot;data/RGIS/landCover.tif&quot;</span>))</span>
<span id="cb82-3"><a href="geodata.html#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="geodata.html#cb82-4" tabindex="-1"></a><span class="co"># Inspect the current levels (classes) of the raster</span></span>
<span id="cb82-5"><a href="geodata.html#cb82-5" tabindex="-1"></a>current_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(landCover)[[<span class="dv">1</span>]]</span>
<span id="cb82-6"><a href="geodata.html#cb82-6" tabindex="-1"></a><span class="fu">print</span>(current_levels)</span></code></pre></div>
<pre><code>##   ID landCover
## 1 11        11
## 2 15        15
## 3 21        21
## 4 31        31
## 5 41        41
## 6 51        51
## 7 62        62</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="geodata.html#cb84-1" tabindex="-1"></a><span class="co"># Define a vector of new class names (descriptions)</span></span>
<span id="cb84-2"><a href="geodata.html#cb84-2" tabindex="-1"></a>new_class_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb84-3"><a href="geodata.html#cb84-3" tabindex="-1"></a> <span class="st">&quot;11&quot;</span> <span class="ot">=</span> <span class="st">&quot;Impermeable man-made&quot;</span>,</span>
<span id="cb84-4"><a href="geodata.html#cb84-4" tabindex="-1"></a> <span class="st">&quot;15&quot;</span> <span class="ot">=</span> <span class="st">&quot;Permeable man-made&quot;</span>,</span>
<span id="cb84-5"><a href="geodata.html#cb84-5" tabindex="-1"></a> <span class="st">&quot;21&quot;</span> <span class="ot">=</span> <span class="st">&quot;Herbaceous vegetation&quot;</span>,</span>
<span id="cb84-6"><a href="geodata.html#cb84-6" tabindex="-1"></a> <span class="st">&quot;31&quot;</span> <span class="ot">=</span> <span class="st">&quot;Shrub vegetation&quot;</span>,</span>
<span id="cb84-7"><a href="geodata.html#cb84-7" tabindex="-1"></a> <span class="st">&quot;41&quot;</span> <span class="ot">=</span> <span class="st">&quot;Forest&quot;</span>,</span>
<span id="cb84-8"><a href="geodata.html#cb84-8" tabindex="-1"></a> <span class="st">&quot;51&quot;</span> <span class="ot">=</span> <span class="st">&quot;No vegetation&quot;</span>,</span>
<span id="cb84-9"><a href="geodata.html#cb84-9" tabindex="-1"></a> <span class="st">&quot;62&quot;</span> <span class="ot">=</span> <span class="st">&quot;Glacier and water body&quot;</span>)</span>
<span id="cb84-10"><a href="geodata.html#cb84-10" tabindex="-1"></a></span>
<span id="cb84-11"><a href="geodata.html#cb84-11" tabindex="-1"></a><span class="co"># Ensure that new class names match the existing levels</span></span>
<span id="cb84-12"><a href="geodata.html#cb84-12" tabindex="-1"></a>current_levels<span class="sc">$</span>landCover <span class="ot">&lt;-</span> new_class_names[<span class="fu">as.character</span>(current_levels<span class="sc">$</span>ID)]</span>
<span id="cb84-13"><a href="geodata.html#cb84-13" tabindex="-1"></a></span>
<span id="cb84-14"><a href="geodata.html#cb84-14" tabindex="-1"></a><span class="co"># Apply the new class names to the levels of the raster</span></span>
<span id="cb84-15"><a href="geodata.html#cb84-15" tabindex="-1"></a><span class="fu">levels</span>(landCover) <span class="ot">&lt;-</span> current_levels</span>
<span id="cb84-16"><a href="geodata.html#cb84-16" tabindex="-1"></a></span>
<span id="cb84-17"><a href="geodata.html#cb84-17" tabindex="-1"></a><span class="co"># Verify the new levels</span></span>
<span id="cb84-18"><a href="geodata.html#cb84-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">levels</span>(landCover))</span></code></pre></div>
<pre><code>## [[1]]
##   ID              landCover
## 1 11   Impermeable man-made
## 2 15     Permeable man-made
## 3 21  Herbaceous vegetation
## 4 31       Shrub vegetation
## 5 41                 Forest
## 6 51          No vegetation
## 7 62 Glacier and water body</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="geodata.html#cb86-1" tabindex="-1"></a><span class="co"># Create a color palette with enough colors for all classes</span></span>
<span id="cb86-2"><a href="geodata.html#cb86-2" tabindex="-1"></a></span>
<span id="cb86-3"><a href="geodata.html#cb86-3" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb86-4"><a href="geodata.html#cb86-4" tabindex="-1"></a></span>
<span id="cb86-5"><a href="geodata.html#cb86-5" tabindex="-1"></a>num_classes <span class="ot">&lt;-</span> <span class="fu">length</span>(new_class_names)</span>
<span id="cb86-6"><a href="geodata.html#cb86-6" tabindex="-1"></a>color_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Set3&quot;</span>))(num_classes)</span>
<span id="cb86-7"><a href="geodata.html#cb86-7" tabindex="-1"></a></span>
<span id="cb86-8"><a href="geodata.html#cb86-8" tabindex="-1"></a><span class="co"># Plot the land cover data with the custom color palette</span></span>
<span id="cb86-9"><a href="geodata.html#cb86-9" tabindex="-1"></a><span class="fu">plot</span>(landCover, <span class="at">col =</span> color_palette, <span class="at">main =</span> <span class="st">&quot;Land Cover Classes&quot;</span>)</span></code></pre></div>
<p><img src="02-RGIS_files/figure-html/landCover-map-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="further-reading" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Further Reading<a href="geodata.html#further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter aims to provide an overview of the main functionalities integrated into the R packages <strong>sf</strong> and <strong>terra</strong> for vector and raster data manipulation. For more in-depth knowledge and understanding, you can refer to the following documentation:</p>
<ul>
<li><p><code>sf</code> <a href="https://r-spatial.github.io/sf/index.html">Simple Features for R</a></p></li>
<li><p><code>terra</code> <a href="https://rspatial.github.io/terra/index.html">R package for spatial data analysis</a></p></li>
<li><p><code>dplyr</code> <a href="https://dplyr.tidyverse.org/index.html">Solves most common data manipulation challenges</a></p></li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Hijmans_2024" class="csl-entry">
Hijmans, Robert J. 2024. <em>Terra: Spatial Data Analysis</em>. <a href="https://rspatial.org/">https://rspatial.org/</a>.
</div>
<div id="ref-Pebesma_2018" class="csl-entry">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–446. doi:<a href="https://doi.org/10.32614/RJ-2018-009">10.32614/RJ-2018-009</a>.
</div>
<div id="ref-Pebesma_2023" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <em><span class="nocase">Spatial Data Science: With applications in R</span></em>. <span>Chapman and Hall/CRC</span>. doi:<a href="https://doi.org/10.1201/9780429459016">10.1201/9780429459016</a>.
</div>
<div id="ref-Wickham_et_al_2003" class="csl-entry">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://dplyr.tidyverse.org">https://dplyr.tidyverse.org</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gwss.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/EugeneGIS/AGDAbook/edit/master/02-RGIS.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fake-book.pdf", "fake-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toc_depth": 2
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
