<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach | Advanced Geospatial Data Analysis with R – Applications in Geosciences</title>
  <meta name="description" content="Chapter 8 Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach | Advanced Geospatial Data Analysis with R – Applications in Geosciences" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach | Advanced Geospatial Data Analysis with R – Applications in Geosciences" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach | Advanced Geospatial Data Analysis with R – Applications in Geosciences" />
  
  
  

<meta name="author" content="Dr. Marj Tonini, Haokun Liu" />


<meta name="date" content="2024-08-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="local-random-forest.html"/>
<link rel="next" href="dbscan-for-3d-features-detection-in-geosciences.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/AGDA_ImageCover.webp"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-overview"><i class="fa fa-check"></i>Book overview</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computing-lab"><i class="fa fa-check"></i>Computing lab</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#target-audience"><i class="fa fa-check"></i>Target audience</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-information"><i class="fa fa-check"></i>Authors information</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-journey-of-learning-integrating-geospatial-data-analysis-with-data-science"><i class="fa fa-check"></i>My Journey of Learning: Integrating Geospatial Data Analysis with Data Science</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-packages"><i class="fa fa-check"></i><b>1.1.1</b> R Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#some-tips"><i class="fa fa-check"></i><b>1.1.2</b> Some tips</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-commands-online-resources"><i class="fa fa-check"></i><b>1.1.3</b> R Commands (online resources)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-markdown"><i class="fa fa-check"></i><b>1.2</b> R Markdown</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-type-in-computational-analysis"><i class="fa fa-check"></i><b>1.3</b> Data type in computational analysis</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.3.1</b> Variables</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structure-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Data structure in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html"><i class="fa fa-check"></i><b>2</b> Basic operation with geodata in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#plotting-vector-dataset"><i class="fa fa-check"></i><b>2.2</b> Plotting vector dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#package-sf-for-vector-dataset"><i class="fa fa-check"></i><b>2.2.1</b> Package <strong><em>sf</em></strong> for vector dataset</a></li>
<li class="chapter" data-level="2.2.2" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#plot-vector-features"><i class="fa fa-check"></i><b>2.2.2</b> Plot vector features</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#plotting-raster-dataset"><i class="fa fa-check"></i><b>2.3</b> Plotting raster dataset</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#terra-package-and-raster-dataset"><i class="fa fa-check"></i><b>2.3.1</b> Terra package and raster dataset</a></li>
<li class="chapter" data-level="2.3.2" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#plot-raster-features"><i class="fa fa-check"></i><b>2.3.2</b> Plot raster features</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#geodata-manipulation"><i class="fa fa-check"></i><b>2.4</b> Geodata manipulation</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#manipulate-tabular-datasets"><i class="fa fa-check"></i><b>2.4.1</b> Manipulate tabular datasets</a></li>
<li class="chapter" data-level="2.4.2" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#pipes-chaining-of-multiple-operations"><i class="fa fa-check"></i><b>2.4.2</b> Pipes: chaining of multiple operations</a></li>
<li class="chapter" data-level="2.4.3" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#join-table"><i class="fa fa-check"></i><b>2.4.3</b> Join table</a></li>
<li class="chapter" data-level="2.4.4" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#mapping-with-ggplot2"><i class="fa fa-check"></i><b>2.4.4</b> Mapping with ggplot2</a></li>
<li class="chapter" data-level="2.4.5" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#cropping-ratser"><i class="fa fa-check"></i><b>2.4.5</b> Cropping ratser</a></li>
<li class="chapter" data-level="2.4.6" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#display-the-categorical-variables-of-a-raster"><i class="fa fa-check"></i><b>2.4.6</b> Display the categorical variables of a raster</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="basic-operation-with-geodata-in-r.html"><a href="basic-operation-with-geodata-in-r.html#further-reading"><i class="fa fa-check"></i><b>2.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html"><i class="fa fa-check"></i><b>3</b> Geographically Weighted Summary Statistics for Geosciences</a>
<ul>
<li class="chapter" data-level="3.1" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#gwss-for-natural-hazards-assessment"><i class="fa fa-check"></i><b>3.1</b> GWSS for natural hazards assessment</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#the-overall-methodology"><i class="fa fa-check"></i><b>3.1.1</b> The overall methodology</a></li>
<li class="chapter" data-level="3.1.2" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#forest-fires-dataset"><i class="fa fa-check"></i><b>3.1.2</b> Forest fires dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#computing-lab-gwss"><i class="fa fa-check"></i><b>3.2</b> Computing lab: GWSS</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#load-the-libraries"><i class="fa fa-check"></i><b>3.2.1</b> Load the libraries</a></li>
<li class="chapter" data-level="3.2.2" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#import-the-forest-fire-dataset"><i class="fa fa-check"></i><b>3.2.2</b> Import the forest fire dataset</a></li>
<li class="chapter" data-level="3.2.3" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#forest-fires-spatial-distribution"><i class="fa fa-check"></i><b>3.2.3</b> Forest fires spatial distribution</a></li>
<li class="chapter" data-level="3.2.4" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#compute-the-gwss"><i class="fa fa-check"></i><b>3.2.4</b> Compute the GWSS</a></li>
<li class="chapter" data-level="3.2.5" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#look-at-the-results"><i class="fa fa-check"></i><b>3.2.5</b> Look at the results</a></li>
<li class="chapter" data-level="3.2.6" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#gwss-maps"><i class="fa fa-check"></i><b>3.2.6</b> GWSS maps</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="geographically-weighted-summary-statistics-for-geosciences.html"><a href="geographically-weighted-summary-statistics-for-geosciences.html#conclusions-and-further-analyses"><i class="fa fa-check"></i><b>3.3</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><i class="fa fa-check"></i><b>4</b> Spatio-Temporal Cluster Analysis of Geoenvironmental Processes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#st-clustering-for-fire-management"><i class="fa fa-check"></i><b>4.1</b> ST clustering for fire management</a></li>
<li class="chapter" data-level="4.2" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#clustering-methods"><i class="fa fa-check"></i><b>4.2</b> Clustering methods</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#ripleys-k-function"><i class="fa fa-check"></i><b>4.2.1</b> Ripley’s K-function</a></li>
<li class="chapter" data-level="4.2.2" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#kernel-density-estimator"><i class="fa fa-check"></i><b>4.2.2</b> Kernel density estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#computing-lab-spatio-temporal-clustering"><i class="fa fa-check"></i><b>4.3</b> Computing lab: spatio-temporal clustering</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#load-the-libraries-1"><i class="fa fa-check"></i><b>4.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="4.3.2" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#import-the-forest-fire-dataset-1"><i class="fa fa-check"></i><b>4.3.2</b> Import the forest fire dataset</a></li>
<li class="chapter" data-level="4.3.3" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#ff-subsets-based-on-the-burned-areas-size"><i class="fa fa-check"></i><b>4.3.3</b> FF-subsets based on the burned areas’ size</a></li>
<li class="chapter" data-level="4.3.4" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#ff-subsets-based-on-the-geographical-distribution"><i class="fa fa-check"></i><b>4.3.4</b> FF-subsets based on the geographical distribution</a></li>
<li class="chapter" data-level="4.3.5" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#extract-time-and-pts-object"><i class="fa fa-check"></i><b>4.3.5</b> Extract time and PTS object</a></li>
<li class="chapter" data-level="4.3.6" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#compute-the-space-time-k-function"><i class="fa fa-check"></i><b>4.3.6</b> Compute the space-time K-function</a></li>
<li class="chapter" data-level="4.3.7" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#assess-the-space-time-clustering-behavior"><i class="fa fa-check"></i><b>4.3.7</b> Assess the space-time clustering behavior</a></li>
<li class="chapter" data-level="4.3.8" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#compute-the-space-time-kernel-density-estimator"><i class="fa fa-check"></i><b>4.3.8</b> Compute the space-time Kernel Density Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html"><a href="spatio-temporal-cluster-analysis-of-geoenvironmental-processes.html#conclusions-and-further-analyses-1"><i class="fa fa-check"></i><b>4.4</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html"><i class="fa fa-check"></i><b>5</b> Predictive Mapping of Natural Hazards Using Random Forest</a>
<ul>
<li class="chapter" data-level="5.1" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#rf-for-landslides-susceptibility-mapping"><i class="fa fa-check"></i><b>5.1</b> RF for landslides susceptibility mapping</a></li>
<li class="chapter" data-level="5.2" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#computing-lab-random-forest"><i class="fa fa-check"></i><b>5.2</b> Computing lab: Random Forest</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#load-the-libraries-2"><i class="fa fa-check"></i><b>5.2.1</b> Load the libraries</a></li>
<li class="chapter" data-level="5.2.2" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#load-the-input-datasets"><i class="fa fa-check"></i><b>5.2.2</b> Load the input datasets</a></li>
<li class="chapter" data-level="5.2.3" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#the-use-of-categorical-variables-in-machine-learning"><i class="fa fa-check"></i><b>5.2.3</b> The use of categorical variables in Machine Learning</a></li>
<li class="chapter" data-level="5.2.4" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#extract-the-values"><i class="fa fa-check"></i><b>5.2.4</b> Extract the values</a></li>
<li class="chapter" data-level="5.2.5" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#split-the-input-dataset-into-training-and-testing"><i class="fa fa-check"></i><b>5.2.5</b> Split the input dataset into training and testing</a></li>
<li class="chapter" data-level="5.2.6" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#run-random-forest"><i class="fa fa-check"></i><b>5.2.6</b> Run Random Forest</a></li>
<li class="chapter" data-level="5.2.7" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#rf-main-outputs"><i class="fa fa-check"></i><b>5.2.7</b> RF main outputs</a></li>
<li class="chapter" data-level="5.2.8" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#model-evaluation"><i class="fa fa-check"></i><b>5.2.8</b> Model evaluation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#susceptibility-mapping"><i class="fa fa-check"></i><b>5.3</b> Susceptibility mapping</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#class-intervals-for-decision-maker"><i class="fa fa-check"></i><b>5.3.1</b> Class intervals for decision maker</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#conclusions-and-further-analyses-2"><i class="fa fa-check"></i><b>5.4</b> Conclusions and further analyses</a></li>
<li class="chapter" data-level="5.5" data-path="predictive-mapping-of-natural-hazards-using-random-forest.html"><a href="predictive-mapping-of-natural-hazards-using-random-forest.html#further-reading-on-this-topic"><i class="fa fa-check"></i><b>5.5</b> Further reading on this topic</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html"><i class="fa fa-check"></i><b>6</b> Interpretability &amp; Explainability with Random Forest</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html#aim-of-the-present-lab"><i class="fa fa-check"></i><b>6.1</b> Aim of the present lab</a></li>
<li class="chapter" data-level="6.2" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html#computing-lab-tools-to-comprehend-rf"><i class="fa fa-check"></i><b>6.2</b> Computing lab: tools to comprehend RF</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html#re-load-libraries-and-workspace"><i class="fa fa-check"></i><b>6.2.1</b> Re-load libraries and workspace</a></li>
<li class="chapter" data-level="6.2.2" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html#surrogate-model"><i class="fa fa-check"></i><b>6.2.2</b> Surrogate model</a></li>
<li class="chapter" data-level="6.2.3" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html#features-importance-score"><i class="fa fa-check"></i><b>6.2.3</b> Features importance score</a></li>
<li class="chapter" data-level="6.2.4" data-path="interpretability-explainability-with-random-forest.html"><a href="interpretability-explainability-with-random-forest.html#partial-dependence-plot"><i class="fa fa-check"></i><b>6.2.4</b> Partial dependence plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="local-random-forest.html"><a href="local-random-forest.html"><i class="fa fa-check"></i><b>7</b> Local Random Forest</a>
<ul>
<li class="chapter" data-level="7.1" data-path="local-random-forest.html"><a href="local-random-forest.html#computing-lab-grf"><i class="fa fa-check"></i><b>7.1</b> Computing lab: GRF</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="local-random-forest.html"><a href="local-random-forest.html#feature-importance"><i class="fa fa-check"></i><b>7.1.1</b> Feature importance</a></li>
<li class="chapter" data-level="7.1.2" data-path="local-random-forest.html"><a href="local-random-forest.html#local-r-squared"><i class="fa fa-check"></i><b>7.1.2</b> Local R squared</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="local-random-forest.html"><a href="local-random-forest.html#conclusions-and-further-analyses-3"><i class="fa fa-check"></i><b>7.2</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><i class="fa fa-check"></i><b>8</b> Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach</a>
<ul>
<li class="chapter" data-level="8.1" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#geo-demographic-context-in-switzerland"><i class="fa fa-check"></i><b>8.1</b> Geo-demographic context in Switzerland</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#swiss-census-data"><i class="fa fa-check"></i><b>8.1.1</b> Swiss census data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#self-organizing-map"><i class="fa fa-check"></i><b>8.2</b> Self Organizing Map</a></li>
<li class="chapter" data-level="8.3" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#computing-lab-som"><i class="fa fa-check"></i><b>8.3</b> Computing lab: SOM</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#load-the-libraries-3"><i class="fa fa-check"></i><b>8.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="8.3.2" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#import-the-swiss-census-dataset"><i class="fa fa-check"></i><b>8.3.2</b> Import the Swiss census dataset</a></li>
<li class="chapter" data-level="8.3.3" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#run-som"><i class="fa fa-check"></i><b>8.3.3</b> Run SOM</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#hierarchical-clustering"><i class="fa fa-check"></i><b>8.4</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#map-clusters-onto-the-geographical-space"><i class="fa fa-check"></i><b>8.4.1</b> <strong>Map clusters onto the geographical space</strong></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#clusters-characterization"><i class="fa fa-check"></i><b>8.5</b> Clusters characterization</a></li>
<li class="chapter" data-level="8.6" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#conclusions"><i class="fa fa-check"></i><b>8.6</b> Conclusions</a></li>
<li class="chapter" data-level="8.7" data-path="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#further-analyses"><i class="fa fa-check"></i><b>8.7</b> Further analyses</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html"><i class="fa fa-check"></i><b>9</b> DBSCAN for 3D features detection in geosciences</a>
<ul>
<li class="chapter" data-level="9.1" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#the-overall-methodology-1"><i class="fa fa-check"></i><b>9.1</b> The overall methodology</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#dbscan-3-d-density-based-clustering-algorithm"><i class="fa fa-check"></i><b>9.1.1</b> DBSCAN: 3-D density based clustering algorithm</a></li>
<li class="chapter" data-level="9.1.2" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#field-campaign"><i class="fa fa-check"></i><b>9.1.2</b> Field campaign</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#computing-lab-dbscan"><i class="fa fa-check"></i><b>9.2</b> Computing lab: DBSCAN</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#load-the-libraries-4"><i class="fa fa-check"></i><b>9.2.1</b> Load the libraries</a></li>
<li class="chapter" data-level="9.2.2" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#import-and-visualize-the-point-clouds-dataset"><i class="fa fa-check"></i><b>9.2.2</b> Import and visualize the point clouds dataset</a></li>
<li class="chapter" data-level="9.2.3" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#compute-dbscan"><i class="fa fa-check"></i><b>9.2.3</b> Compute DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="dbscan-for-3d-features-detection-in-geosciences.html"><a href="dbscan-for-3d-features-detection-in-geosciences.html#conclusions-and-further-analyses-4"><i class="fa fa-check"></i><b>9.3</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Geospatial Data Analysis with R – Applications in Geosciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="defining-territorial-typologies-using-unsupervised-learning-a-som-approach" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Defining Territorial Typologies Using Unsupervised Learning: A SOM Approach<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#defining-territorial-typologies-using-unsupervised-learning-a-som-approach" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Urban expansion across Europe has accelerated in recent decades, significantly blurring the distinctions between urban and rural landscapes.
The growing complexity and constant evolution of territorial dynamics require timely urban-rural typologies that systematically classify areas along the continuum from distinctly urban to distinctly rural.
Traditional threshold-based classification methods rely heavily on expert input and are labor-intensive, hindering timely updates.
This study addresses the issue by developing an unsupervised learning approach based on <strong>Self-Organizing Map (SOM)</strong> <span class="citation">(<a href="#ref-kohonen_self-organized_1982">Kohonen, 1982</a>)</span> to group Swiss municipalities, using a diverse set of demographic, socioeconomic, and built environment variables.</p>
<div id="geo-demographic-context-in-switzerland" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Geo-demographic context in Switzerland<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#geo-demographic-context-in-switzerland" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Switzerland has the highest life expectancy in the world.
It counts about 8,5 million inhabitants (official census data 2020), twice as much as at the beginning of the 20th century, mainly because of the high level of immigration.
The number of foreigners that currently reside in the country corresponds to about one quarter of the total population.
Most of the population (85%) lives in cities.
Population aging increased over the course of the 20th century, with one in five person of retirement age today.</p>
<div id="swiss-census-data" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Swiss census data<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#swiss-census-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The input census data used in this study come from the <a href="https://www.bfs.admin.ch/bfs/en/home.html">Swiss Federal Statistical Office</a> and have been downloaded from the Statistical Atlas of Switzerland <span class="citation">(<a href="#ref-FSO_2024">Federal Statistical Office, 2024</a>)</span>.
Following an in-depth analysis of all data available in the Atlas, eighteen variables from the 2020 census were selected.
These variables provide a comprehensive overview of the physical environment (including settlement, forest, agricultural, unproductive, and traffic areas), demographic characteristics (such as natural growth, population density, international and internal migration, proportion of foreigners, youth, and senior population), and the socio-economic profile (covering employment, new buildings, new houses, individual housing, new enterprises, and net income) of the resident population.
This information has been aggregated to the municipality level for the purpose of the present investigation.</p>
</div>
</div>
<div id="self-organizing-map" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Self Organizing Map<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#self-organizing-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We use SOM, an unsupervised competitive learning neural network allowing representing a high-dimensional feature space (defined by the multivariate input dataset), as two-dimensional discretized pattern (the SOM grid of neurons).
In SOM the proximity of the units in the output grid reflects the similarity of the corresponding input observations, which guarantees the preservation of the topological structure of the input data.</p>
<p>Compared to other approaches, SOM is very efficient for data visualization.
Indeed it provides additional outputs such as the heatmaps, representing the distribution of each input feature across the SOM grid, extremely useful to visually explore the relationship between the input variables.</p>
</div>
<div id="computing-lab-som" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Computing lab: SOM<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#computing-lab-som" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-the-libraries-3" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Load the libraries<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#load-the-libraries-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To perform the analyses and visualize the results you have to load the following libraries:</p>
<ul>
<li><em>kohonen</em>: Supervised and Unsupervised Self-Organizing Maps (SOM)</li>
<li><em>aweSOM</em><strong>:</strong> offers a set of tools to explore and analyze datasets with SOM</li>
<li><em>ggplot2</em>: create Elegant Data Visualizations Using the Grammar of Graphics</li>
<li><em>colorpatch</em>: rendering methods (ggplot extensions)</li>
</ul>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb189-1" tabindex="-1"></a><span class="fu">library</span>(kohonen)</span>
<span id="cb189-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb189-2" tabindex="-1"></a><span class="fu">library</span>(aweSOM)</span>
<span id="cb189-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb189-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb189-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb189-4" tabindex="-1"></a><span class="fu">library</span>(colorpatch)</span>
<span id="cb189-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb189-5" tabindex="-1"></a>(<span class="fu">.packages</span>())</span></code></pre></div>
</div>
<div id="import-the-swiss-census-dataset" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Import the Swiss census dataset<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#import-the-swiss-census-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fist, you have to import the Swiss census dataset for the year 2020, referred to the municipality administrative units.
As you can see from the description of the selected variables , some of them can be discarded from the analysis.
So, in the following step, we extract a subset of the most meaningful variables for the purpose of the present study.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb190-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">c</span>(<span class="st">&quot;images/Variables1.jpg&quot;</span>, <span class="st">&quot;images/Variables2.jpg&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:variables-1"></span>
<img src="images/Variables1.jpg" alt="Variables description \label{Variables}" width="100%" height="100%" />
<p class="caption">
Figure 8.1: Variables description
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:variables-2"></span>
<img src="images/Variables2.jpg" alt="Variables description \label{Variables}" width="100%" height="100%" />
<p class="caption">
Figure 8.2: Variables description
</p>
</div>
<div id="inspect-the-data" class="section level4 hasAnchor" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Inspect the data<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#inspect-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Histograms can be used to show the frequency distribution of the variables and help detect patterns, such as skewness, outliers, and the range of values. Similarly, box plots summarize data using quartiles, helping to identify central tendency, spread, and outliers. Together, these visual tools allow to asses if variables have comparable ranges and help determine if data transformation is needed.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb191-1" tabindex="-1"></a><span class="co"># Plot variables&#39; frequency distribution</span></span>
<span id="cb191-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb191-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(subset2020)) {      </span>
<span id="cb191-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb191-3" tabindex="-1"></a>    <span class="fu">hist</span>((subset2020[ , i]),  <span class="at">main=</span><span class="fu">colnames</span>(subset2020[i]))</span>
<span id="cb191-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb191-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb192-1" tabindex="-1"></a><span class="co"># Plot variables&#39; frequency distribution</span></span>
<span id="cb192-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb192-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(subset2020)) {      </span>
<span id="cb192-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb192-3" tabindex="-1"></a>    <span class="fu">boxplot</span>((subset2020[ , i]),  <span class="at">main=</span><span class="fu">colnames</span>(subset2020[i]))</span>
<span id="cb192-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb192-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="data-transformation" class="section level4 hasAnchor" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Data transformation<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#data-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To make the variables range comparable, we propose to operate the max-min normalization scaling input census data in the range [0 – 1]. Computationally it subtracts the minimum value from the original one, and then it divides the result by the range (i.e., difference between the maximum and minimum values). This process ensures that all variables in the dataset are in the same range, and can be treated and evaluated together.</p>
<p>However, the min-max transformation is sensitive to outliers, as extreme values can distort the interpretation by compressing the range. To mitigate this, values beyond the upper and lower 5th percentiles will be capped at these thresholds before operating the max-min normalization.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-1" tabindex="-1"></a><span class="co"># Define the general function to detect outlier</span></span>
<span id="cb193-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-2" tabindex="-1"></a>replace_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(df, lower_quantile_value, upper_quantile_value) {</span>
<span id="cb193-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-3" tabindex="-1"></a>  replaced_df <span class="ot">&lt;-</span> df</span>
<span id="cb193-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-4" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(df)) {</span>
<span id="cb193-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-5" tabindex="-1"></a>    lower_quantile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df[[col]], <span class="at">probs =</span> lower_quantile_value)</span>
<span id="cb193-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-6" tabindex="-1"></a>    upper_quantile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df[[col]], <span class="at">probs =</span> upper_quantile_value)</span>
<span id="cb193-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-7" tabindex="-1"></a>    outlier_indices_lower <span class="ot">&lt;-</span> df[[col]] <span class="sc">&lt;</span> lower_quantile</span>
<span id="cb193-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-8" tabindex="-1"></a>    outlier_indices_upper <span class="ot">&lt;-</span> df[[col]] <span class="sc">&gt;</span> upper_quantile</span>
<span id="cb193-9"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-9" tabindex="-1"></a>    replaced_df[[col]][outlier_indices_lower] <span class="ot">&lt;-</span> lower_quantile</span>
<span id="cb193-10"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-10" tabindex="-1"></a>    replaced_df[[col]][outlier_indices_upper] <span class="ot">&lt;-</span> upper_quantile</span>
<span id="cb193-11"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-11" tabindex="-1"></a>  }</span>
<span id="cb193-12"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-12" tabindex="-1"></a>  <span class="fu">return</span>(replaced_df)</span>
<span id="cb193-13"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-13" tabindex="-1"></a>}</span>
<span id="cb193-14"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-14" tabindex="-1"></a></span>
<span id="cb193-15"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-15" tabindex="-1"></a><span class="co"># Define the percentile level</span></span>
<span id="cb193-16"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-16" tabindex="-1"></a>lower_quantile_value <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb193-17"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-17" tabindex="-1"></a>upper_quantile_value <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb193-18"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-18" tabindex="-1"></a></span>
<span id="cb193-19"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-19" tabindex="-1"></a><span class="co"># Replace outliers in all variables with upper and lower quantile values</span></span>
<span id="cb193-20"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-20" tabindex="-1"></a></span>
<span id="cb193-21"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-21" tabindex="-1"></a>df2020_out_repl <span class="ot">&lt;-</span> <span class="fu">replace_outliers</span>((subset2020[ , <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]), lower_quantile_value, upper_quantile_value)</span>
<span id="cb193-22"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb193-22" tabindex="-1"></a><span class="fu">summary</span> (df2020_out_repl)</span></code></pre></div>
<pre><code>##  p_infrastructure    p_forested      p_agriculture    p_improductible   
##  Min.   :0.01906   Min.   :0.07797   Min.   :0.1030   Min.   :0.000000  
##  1st Qu.:0.06232   1st Qu.:0.20751   1st Qu.:0.3190   1st Qu.:0.003188  
##  Median :0.10815   Median :0.31211   Median :0.4694   Median :0.010854  
##  Mean   :0.15093   Mean   :0.32368   Mean   :0.4492   Mean   :0.056692  
##  3rd Qu.:0.20430   3rd Qu.:0.42620   3rd Qu.:0.5970   3rd Qu.:0.047372  
##  Max.   :0.48058   Max.   :0.61755   Max.   :0.7312   Max.   :0.402194  
##   p_transport      natural_growth       density        migration_intern 
##  Min.   : 0.7136   Min.   :-9.0172   Min.   :  16.42   Min.   :-24.648  
##  1st Qu.: 1.9811   1st Qu.:-2.1720   1st Qu.:  82.34   1st Qu.: -7.159  
##  Median : 3.2459   Median : 0.8865   Median : 189.46   Median :  2.575  
##  Mean   : 4.1497   Mean   : 0.7120   Mean   : 374.19   Mean   :  3.904  
##  3rd Qu.: 5.4475   3rd Qu.: 3.9575   3rd Qu.: 480.88   3rd Qu.: 13.534  
##  Max.   :11.9374   Max.   : 9.2336   Max.   :1662.06   Max.   : 37.746  
##    migration       p_foreigners    p_individual_houses    p_pop_19    
##  Min.   :-5.896   Min.   : 4.419   Min.   :32.94       Min.   :14.83  
##  1st Qu.: 0.000   1st Qu.: 9.736   1st Qu.:51.46       1st Qu.:18.61  
##  Median : 3.389   Median :15.432   Median :61.54       Median :20.53  
##  Mean   : 4.071   Mean   :16.915   Mean   :59.55       Mean   :20.44  
##  3rd Qu.: 7.250   3rd Qu.:23.487   3rd Qu.:68.93       3rd Qu.:22.38  
##  Max.   :17.350   Max.   :35.327   Max.   :78.69       Max.   :25.47  
##     p_pop_65      p_employment     p_new_buildings  p_new_housings   
##  Min.   :13.22   Min.   :0.07255   Min.   :0.0000   Min.   : 0.0000  
##  1st Qu.:16.60   1st Qu.:0.14204   1st Qu.:0.3201   1st Qu.: 0.5315  
##  Median :19.16   Median :0.22970   Median :1.2799   Median : 3.0057  
##  Mean   :19.51   Mean   :0.28020   Mean   :1.7691   Mean   : 5.0709  
##  3rd Qu.:21.95   3rd Qu.:0.36167   3rd Qu.:2.6316   3rd Qu.: 7.2601  
##  Max.   :27.60   Max.   :0.75642   Max.   :6.2107   Max.   :21.1283  
##  p_new_entreprise     net_income   
##  Min.   :0.000000   Min.   :25908  
##  1st Qu.:0.000000   1st Qu.:30789  
##  Median :0.002931   Median :34960  
##  Mean   :0.002806   Mean   :36848  
##  3rd Qu.:0.004514   3rd Qu.:40433  
##  Max.   :0.007919   Max.   :59032</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-1" tabindex="-1"></a><span class="co"># Define the general function for min-max normalization</span></span>
<span id="cb195-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-2" tabindex="-1"></a>minMax <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb195-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-3" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb195-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-4" tabindex="-1"></a>}</span>
<span id="cb195-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-5" tabindex="-1"></a></span>
<span id="cb195-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-6" tabindex="-1"></a><span class="co"># Apply max-min to the data</span></span>
<span id="cb195-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-7" tabindex="-1"></a>dfnorm2020_out_repl<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>((df2020_out_repl), minMax))</span>
<span id="cb195-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb195-8" tabindex="-1"></a><span class="fu">summary</span>(dfnorm2020_out_repl)</span></code></pre></div>
<pre><code>##  p_infrastructure    p_forested     p_agriculture    p_improductible   
##  Min.   :0.00000   Min.   :0.0000   Min.   :0.0000   Min.   :0.000000  
##  1st Qu.:0.09373   1st Qu.:0.2401   1st Qu.:0.3439   1st Qu.:0.007927  
##  Median :0.19304   Median :0.4339   Median :0.5833   Median :0.026987  
##  Mean   :0.28573   Mean   :0.4554   Mean   :0.5510   Mean   :0.140958  
##  3rd Qu.:0.40137   3rd Qu.:0.6454   3rd Qu.:0.7863   3rd Qu.:0.117785  
##  Max.   :1.00000   Max.   :1.0000   Max.   :1.0000   Max.   :1.000000  
##   p_transport     natural_growth      density        migration_intern
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.00000   Min.   :0.0000  
##  1st Qu.:0.1129   1st Qu.:0.3751   1st Qu.:0.04005   1st Qu.:0.2803  
##  Median :0.2256   Median :0.5426   Median :0.10515   Median :0.4363  
##  Mean   :0.3061   Mean   :0.5331   Mean   :0.21740   Mean   :0.4576  
##  3rd Qu.:0.4218   3rd Qu.:0.7109   3rd Qu.:0.28224   3rd Qu.:0.6119  
##  Max.   :1.0000   Max.   :1.0000   Max.   :1.00000   Max.   :1.0000  
##    migration       p_foreigners    p_individual_houses    p_pop_19     
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000      Min.   :0.0000  
##  1st Qu.:0.2536   1st Qu.:0.1720   1st Qu.:0.4048      1st Qu.:0.3560  
##  Median :0.3994   Median :0.3563   Median :0.6251      Median :0.5357  
##  Mean   :0.4288   Mean   :0.4043   Mean   :0.5816      Mean   :0.5273  
##  3rd Qu.:0.5655   3rd Qu.:0.6169   3rd Qu.:0.7866      3rd Qu.:0.7097  
##  Max.   :1.0000   Max.   :1.0000   Max.   :1.0000      Max.   :1.0000  
##     p_pop_65       p_employment    p_new_buildings   p_new_housings   
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.00000   Min.   :0.00000  
##  1st Qu.:0.2344   1st Qu.:0.1016   1st Qu.:0.05153   1st Qu.:0.02516  
##  Median :0.4130   Median :0.2298   Median :0.20607   Median :0.14226  
##  Mean   :0.4373   Mean   :0.3036   Mean   :0.28485   Mean   :0.24001  
##  3rd Qu.:0.6069   3rd Qu.:0.4228   3rd Qu.:0.42372   3rd Qu.:0.34362  
##  Max.   :1.0000   Max.   :1.0000   Max.   :1.00000   Max.   :1.00000  
##  p_new_entreprise   net_income    
##  Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.0000   1st Qu.:0.1474  
##  Median :0.3702   Median :0.2733  
##  Mean   :0.3543   Mean   :0.3303  
##  3rd Qu.:0.5701   3rd Qu.:0.4385  
##  Max.   :1.0000   Max.   :1.0000</code></pre>
</div>
</div>
<div id="run-som" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Run SOM<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#run-som" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main idea with SOM is to map the input high-dimensional feature space in a lower-dimensional output space organized on a grid made up of regular units (i.e. the neurons).
At the end of the process, each observation from the input space (<span class="math inline">\(X_{k,i}\)</span>) will be associated (i.e., mapped) to a unit in the SOM grid.
Depending on the size of the grid, one unit can include several input observations.</p>
<p>The first step consists in defining the size and geometry of the SOM grid.
In this case we define a rectangular grid of 18 by 13 units, allowing to allocate, on average, about 15 input-items per units, and whose geometry reproduces the shape of the study area.
(NB: several parameters and configurations of the SOM grid can be implemented and compared, seeking to minimize the <em>Quantization Error, QE</em>).
Finally, you can run the SOM model.</p>
<p>For the computation we introduce here the method proposed by <span class="citation">(<a href="#ref-kohonen_self-organized_1982">Kohonen, 1982</a>)</span> and implemented in the R package <code>kohonen</code> <span class="citation">(<a href="#ref-library_SOM">Wehrens &amp; Buydens, 2007</a>)</span>.</p>
<p>####Create the SOM-grid</p>
<p>Before running SOM, you have to transform the data frame to the format matrix and create the grid of output units.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb197-1" tabindex="-1"></a>mx2020<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(dfnorm2020_out_repl) <span class="co"># max-min</span></span></code></pre></div>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb198-1" tabindex="-1"></a><span class="co"># Gird size 18x13 units</span></span>
<span id="cb198-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb198-2" tabindex="-1"></a>som_grid <span class="ot">&lt;-</span> <span class="fu">somgrid</span>(<span class="at">xdim =</span> <span class="dv">20</span>, <span class="at">ydim=</span><span class="dv">15</span>) </span></code></pre></div>
<p>The general R function <code>set.seed</code> is used for creating simulations of random objects that can be reproduced.
The <code>rlen</code> indicates the number of times the complete data set will be presented to the network, while for the other parameters we will keep the default values.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-1" tabindex="-1"></a><span class="co"># Use max-min data transformation</span></span>
<span id="cb199-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb199-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-3" tabindex="-1"></a></span>
<span id="cb199-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-4" tabindex="-1"></a><span class="co"># Run SOM</span></span>
<span id="cb199-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-5" tabindex="-1"></a>SOM2020<span class="ot">&lt;-</span> <span class="fu">som</span>(mx2020,</span>
<span id="cb199-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-6" tabindex="-1"></a>               <span class="at">grid=</span>som_grid, </span>
<span id="cb199-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-7" tabindex="-1"></a>               <span class="at">rlen=</span><span class="dv">1000</span>)</span>
<span id="cb199-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb199-8" tabindex="-1"></a><span class="fu">print</span>(SOM2020)</span></code></pre></div>
<pre><code>## SOM of size 20x15 with a rectangular topology.
## Training data included.</code></pre>
<div id="model-evaluation-1" class="section level4 hasAnchor" number="8.3.3.1">
<h4><span class="header-section-number">8.3.3.1</span> Model evaluation<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#model-evaluation-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, you can optimize the size of the grid by inspecting several quality measure and changing the parameters accordingly.
In particular we will explore the following:</p>
<ul>
<li><strong>Changes</strong>: shows the mean distance to the closest codebook vector during the training.</li>
<li><strong>Quantization error</strong>: average squared distance between the data points and the map’s codebook to which they are mapped. Lower is better.</li>
<li><strong>Percentage of explained variance</strong>: similar to other clustering methods, the share of total variance that is explained by the clustering (equal to 1 minus the ratio of quantization error to total variance). Higher is better.</li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb201-1" tabindex="-1"></a><span class="co"># Evaluate rlen</span></span>
<span id="cb201-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb201-2" tabindex="-1"></a><span class="fu">plot</span>(SOM2020, <span class="at">type=</span><span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="07-SOM_files/figure-html/SOM-quality-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb202-1" tabindex="-1"></a><span class="co"># Evaluate the results</span></span>
<span id="cb202-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb202-2" tabindex="-1"></a>QEM<span class="ot">&lt;-</span><span class="fu">somQuality</span>(SOM2020, dfnorm2020_out_repl) </span>
<span id="cb202-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb202-3" tabindex="-1"></a></span>
<span id="cb202-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb202-4" tabindex="-1"></a><span class="do">## Quality measures:</span></span>
<span id="cb202-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb202-5" tabindex="-1"></a>QEM<span class="sc">$</span>err.quant <span class="co"># Quantization error</span></span></code></pre></div>
<pre><code>## [1] 0.311374</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb204-1" tabindex="-1"></a>QEM<span class="sc">$</span>err.varratio <span class="co"># % explained variance</span></span></code></pre></div>
<pre><code>## [1] 76.53</code></pre>
</div>
<div id="soms-main-outputs" class="section level4 hasAnchor" number="8.3.3.2">
<h4><span class="header-section-number">8.3.3.2</span> SOM’s main outputs<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#soms-main-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The main graphical outputs of SOM are the node counts, the neighborhood distances, and the heatmaps.</p>
<ul>
<li><strong>Node counts map:</strong> informs about the number of input vectors falling inside each output unit.</li>
<li><strong>Neighbourhood distance plot:</strong> shows the distance between each unit and its neighborhoods.</li>
<li><strong>Heatmaps:</strong> dispaly the distribution of each input variable, associated to each input vectors, across the SOM grid.</li>
</ul>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-1" tabindex="-1"></a><span class="co"># Create a color palette</span></span>
<span id="cb206-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-2" tabindex="-1"></a>coolBlueHotRed <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">alpha =</span> <span class="dv">1</span>) {<span class="fu">rainbow</span>(n, <span class="at">end=</span><span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">alpha=</span>alpha)[n<span class="sc">:</span><span class="dv">1</span>]}</span>
<span id="cb206-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-3" tabindex="-1"></a></span>
<span id="cb206-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-4" tabindex="-1"></a><span class="co">#display two plots side-by-side</span></span>
<span id="cb206-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb206-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-6" tabindex="-1"></a></span>
<span id="cb206-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-7" tabindex="-1"></a><span class="co"># Plot node counts map</span></span>
<span id="cb206-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-8" tabindex="-1"></a><span class="fu">plot</span>(SOM2020, <span class="at">type=</span><span class="st">&quot;count&quot;</span>, <span class="at">main=</span><span class="st">&quot;Node counts&quot;</span>, <span class="at">palette.name=</span>coolBlueHotRed)</span>
<span id="cb206-9"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-9" tabindex="-1"></a></span>
<span id="cb206-10"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-10" tabindex="-1"></a><span class="co"># Plot SOM neighbourhood distance</span></span>
<span id="cb206-11"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb206-11" tabindex="-1"></a><span class="fu">plot</span>(SOM2020, <span class="at">type=</span><span class="st">&quot;dist.neighbours&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Neighbour dist.&quot;</span>)</span></code></pre></div>
<p><img src="07-SOM_files/figure-html/outputs-SOM-maxmin-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Side-by-side heatmaps provide a visual comparison, enabling researchers to identify relationships within the high-dimensional input space .
This approach helps assess whether the input variables show similar patterns or complementary trends.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb207-1" tabindex="-1"></a><span class="co"># Plot heatmaps for selected variables</span></span>
<span id="cb207-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb207-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>) </span>
<span id="cb207-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb207-3" tabindex="-1"></a>  {</span>
<span id="cb207-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb207-4" tabindex="-1"></a><span class="fu">plot</span>(SOM2020, <span class="at">type =</span> <span class="st">&quot;property&quot;</span>, <span class="at">property =</span> <span class="fu">getCodes</span>(SOM2020)[,i],</span>
<span id="cb207-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb207-5" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">colnames</span>(<span class="fu">getCodes</span>(SOM2020))[i], <span class="at">palette.name=</span>coolBlueHotRed)</span>
<span id="cb207-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb207-6" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb208-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/Heatmaps.jpg&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:jpg1"></span>
<img src="images/Heatmaps.jpg" alt="Heatmaps \label{Heatmaps}" width="70%" height="70%" />
<p class="caption">
Figure 8.3: Heatmaps
</p>
</div>
</div>
</div>
</div>
<div id="hierarchical-clustering" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Hierarchical clustering<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#hierarchical-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The SOM units were ultimately grouped into a smaller set of primary clusters, representing the territorial typologies in Switzerland based on the 2020 census data.
Hierarchical clustering was applied to generate these final partitions: SOM units are iteratively merged based on Euclidean distance until the desired number of main clusters (six in our case) is achieved.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb209-1" tabindex="-1"></a><span class="co">#Run hierarchical clustering</span></span>
<span id="cb209-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb209-2" tabindex="-1"></a>CV2020 <span class="ot">&lt;-</span> <span class="fu">getCodes</span>(SOM2020) <span class="co"># Extract codebook vectors</span></span>
<span id="cb209-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb209-3" tabindex="-1"></a></span>
<span id="cb209-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb209-4" tabindex="-1"></a>cls2020 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(CV2020)), <span class="dv">6</span>)</span></code></pre></div>
<p>We can display the SOM-grid using different colors for each one of the six final main clusters.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-1" tabindex="-1"></a><span class="co"># Color palette definition.</span></span>
<span id="cb210-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-2" tabindex="-1"></a><span class="co"># NB: If you change the number of hierarchical clustering, remember to set the number of colors accordingly.</span></span>
<span id="cb210-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-3" tabindex="-1"></a></span>
<span id="cb210-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-4" tabindex="-1"></a>map_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;darkolivegreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkolivegreen2&quot;</span>,<span class="st">&quot;khaki1&quot;</span>,<span class="st">&quot;firebrick&quot;</span>,<span class="st">&quot;darkgoldenrod4&quot;</span>)</span>
<span id="cb210-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-5" tabindex="-1"></a></span>
<span id="cb210-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-6" tabindex="-1"></a><span class="fu">plot</span>(SOM2020, <span class="at">type=</span><span class="st">&quot;mapping&quot;</span>, <span class="at">pchs=</span><span class="st">&quot;&quot;</span>, <span class="at">bgcol =</span> map_palette[cls2020], <span class="at">main =</span> <span class="st">&quot;Clusters&quot;</span>)</span>
<span id="cb210-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb210-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;right&quot;</span>, <span class="at">legend =</span> <span class="fu">unique</span>(cls2020), <span class="at">fill =</span> map_palette, <span class="at">title =</span> <span class="st">&quot;Cluster Colors&quot;</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="07-SOM_files/figure-html/clustermap-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-1" tabindex="-1"></a><span class="co">#Assign the cluster number (based on hierarchical clustering) to each unit</span></span>
<span id="cb211-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-2" tabindex="-1"></a></span>
<span id="cb211-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-3" tabindex="-1"></a>clasgn <span class="ot">&lt;-</span> cls2020[SOM2020<span class="sc">$</span>unit.classif]</span>
<span id="cb211-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-4" tabindex="-1"></a>dfnorm2020_out_repl<span class="sc">$</span>hc<span class="ot">&lt;-</span>clasgn</span>
<span id="cb211-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-5" tabindex="-1"></a>clsnorm<span class="ot">&lt;-</span><span class="fu">cbind</span>(dfnorm2020_out_repl, subset2020<span class="sc">$</span>BFS_nummer)</span>
<span id="cb211-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-6" tabindex="-1"></a></span>
<span id="cb211-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-7" tabindex="-1"></a><span class="co"># Export the table with clusters </span></span>
<span id="cb211-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb211-8" tabindex="-1"></a><span class="fu">write.table</span>(clsnorm, <span class="at">file=</span><span class="st">&quot;hcM_6cls.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<div id="map-clusters-onto-the-geographical-space" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> <strong>Map clusters onto the geographical space</strong><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#map-clusters-onto-the-geographical-space" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The six primary clusters can be projected onto the geographical space to elaborate a map that displays the spatial distribution of territorial typologies at the municipal level across the urban-rural continuum in Switzerland.
To this end, you can run the code below.</p>
<p>Alternatively , you can import the final table with clusters into a GIS and join it to the values to the administrative limits at municipality level in Switzerland.
You need only two columns: the code identifying each municipality (“BFS_nummer”) and the cluster number (hc).</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb212-1" tabindex="-1"></a><span class="co">#Load the following packages needed for visualization</span></span>
<span id="cb212-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb212-2" tabindex="-1"></a><span class="fu">library</span>(st)</span>
<span id="cb212-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb212-3" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb212-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb212-4" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb212-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb212-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-1" tabindex="-1"></a><span class="co"># Load the shapefile data</span></span>
<span id="cb213-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-2" tabindex="-1"></a>CH_outline <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/SOM/Municiplities.shp&quot;</span>)</span>
<span id="cb213-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-3" tabindex="-1"></a></span>
<span id="cb213-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-4" tabindex="-1"></a><span class="co"># Quick check the shapefile data</span></span>
<span id="cb213-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-5" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb213-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-6" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> CH_outline, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cyan1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb213-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Swiss municiplities&quot;</span>) <span class="sc">+</span> </span>
<span id="cb213-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb213-8" tabindex="-1"></a>  <span class="fu">coord_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-1" tabindex="-1"></a><span class="co"># Rename the column</span></span>
<span id="cb214-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-2" tabindex="-1"></a><span class="fu">colnames</span>(clsnorm)[<span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="st">&quot;BFS_NUMMER&quot;</span></span>
<span id="cb214-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-3" tabindex="-1"></a></span>
<span id="cb214-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-4" tabindex="-1"></a><span class="co"># Merge the dataframe and shapefile together by the column with the same name</span></span>
<span id="cb214-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-5" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">merge</span>(CH_outline, clsnorm, <span class="at">by =</span> <span class="st">&quot;BFS_NUMMER&quot;</span>)</span>
<span id="cb214-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-6" tabindex="-1"></a></span>
<span id="cb214-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-7" tabindex="-1"></a><span class="co"># Rename the column with clustering results</span></span>
<span id="cb214-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb214-8" tabindex="-1"></a>z<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(z<span class="sc">$</span>hc)</span></code></pre></div>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-1" tabindex="-1"></a><span class="co"># Mapping the clusters using ggplot (as in a GIS)</span></span>
<span id="cb215-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-2" tabindex="-1"></a></span>
<span id="cb215-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-3" tabindex="-1"></a>CH_cluster <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> z) <span class="sc">+</span> <span class="co"># Original data</span></span>
<span id="cb215-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-4" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(cluster))) <span class="sc">+</span> <span class="co"># Mapping the clusters</span></span>
<span id="cb215-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-5" tabindex="-1"></a>    <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="at">width_hint =</span> <span class="fl">0.3</span>,</span>
<span id="cb215-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-6" tabindex="-1"></a>                     <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb215-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-7" tabindex="-1"></a><span class="co"># Mapping scales, which are calculated by project coordinates</span></span>
<span id="cb215-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-8" tabindex="-1"></a>    <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="at">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb215-9"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-9" tabindex="-1"></a>          <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.0</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb215-10"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-10" tabindex="-1"></a>          <span class="at">style =</span> north_arrow_fancy_orienteering) <span class="sc">+</span> <span class="co"># Mapping north arrow</span></span>
<span id="cb215-11"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-11" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkolivegreen&quot;</span>,<span class="st">&quot;darkorange&quot;</span>,<span class="st">&quot;darkolivegreen2&quot;</span>,<span class="st">&quot;khaki1&quot;</span>,<span class="st">&quot;firebrick&quot;</span>,<span class="st">&quot;darkgoldenrod4&quot;</span>), <span class="co"># The same as in personal palette  </span></span>
<span id="cb215-12"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-12" tabindex="-1"></a>                  <span class="at">name=</span><span class="st">&quot;Clusters&quot;</span>,</span>
<span id="cb215-13"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-13" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1: Rural Forest&quot;</span>,</span>
<span id="cb215-14"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-14" tabindex="-1"></a>                    <span class="st">&quot;2: Suburban area&quot;</span>,</span>
<span id="cb215-15"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-15" tabindex="-1"></a>                    <span class="st">&quot;3: Aging Rural&quot;</span>,</span>
<span id="cb215-16"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-16" tabindex="-1"></a>                    <span class="st">&quot;4: Rural Urbanising Frontier&quot;</span>,</span>
<span id="cb215-17"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-17" tabindex="-1"></a>                    <span class="st">&quot;5: Urban area&quot;</span>,</span>
<span id="cb215-18"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-18" tabindex="-1"></a>                    <span class="st">&quot;6: Unproductive/Woodlands&quot;</span>))<span class="sc">+</span></span>
<span id="cb215-19"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-19" tabindex="-1"></a>                  </span>
<span id="cb215-20"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-20" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb215-21"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-21" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Spatial pattern distribution of Swiss population census&quot;</span>)</span>
<span id="cb215-22"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-22" tabindex="-1"></a></span>
<span id="cb215-23"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-23" tabindex="-1"></a><span class="co"># Save the map as jpg</span></span>
<span id="cb215-24"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-24" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;CH_typologies.jpg&quot;</span>)</span>
<span id="cb215-25"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-25" tabindex="-1"></a>    </span>
<span id="cb215-26"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb215-26" tabindex="-1"></a>CH_cluster</span></code></pre></div>
<p><img src="07-SOM_files/figure-html/mapping-clusters-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="clusters-characterization" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Clusters characterization<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#clusters-characterization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To interpret the final main clusters in therms of their geo-demographic characteristics, you can evaluate the distribution of each variable within the clusters by using <strong>box plots</strong> (also known as <em>whisker plot</em>).</p>
<p>Box-plot is a standardized way to display a dataset based on the five-number summary statistics: the minimum, the maximum, the sample median, and the first and third quartiles (i.e., the median of the lower half (25%) and the median of the upper half (75%) of the dataset).</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-1" tabindex="-1"></a><span class="co"># Creates an empty list object that will be filled by the loop</span></span>
<span id="cb216-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-2" tabindex="-1"></a>cls20M <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb216-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-3" tabindex="-1"></a></span>
<span id="cb216-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-4" tabindex="-1"></a><span class="co"># Split the single clusters</span></span>
<span id="cb216-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb216-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-6" tabindex="-1"></a>  cls20M[[i]]<span class="ot">&lt;-</span><span class="fu">subset</span>(clsnorm, clsnorm<span class="sc">$</span>hc<span class="sc">==</span>i) </span>
<span id="cb216-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-7" tabindex="-1"></a>}</span>
<span id="cb216-8"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-8" tabindex="-1"></a></span>
<span id="cb216-9"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-9" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>)) </span>
<span id="cb216-10"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-10" tabindex="-1"></a></span>
<span id="cb216-11"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-11" tabindex="-1"></a><span class="co"># Box-plots for the single clusters</span></span>
<span id="cb216-12"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb216-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.5</span>,  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<p>To better investigate the values assumed by each class of variables withing the different clusters, you can group them by category.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-1" tabindex="-1"></a><span class="co"># Box plot by categories: &quot;Physical space&quot;</span></span>
<span id="cb217-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-2" tabindex="-1"></a></span>
<span id="cb217-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-3" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) </span>
<span id="cb217-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-4" tabindex="-1"></a></span>
<span id="cb217-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb217-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-6" tabindex="-1"></a></span>
<span id="cb217-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb217-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i),  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplot-clsM-PhisicalSpace"></span>
<img src="07-SOM_files/figure-html/boxplot-clsM-PhisicalSpace-1.png" alt="Physical space" width="672" />
<p class="caption">
Figure 8.4: Physical space
</p>
</div>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-1" tabindex="-1"></a><span class="co"># Box plot by categories: &quot;Demographics&quot;</span></span>
<span id="cb218-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-2" tabindex="-1"></a></span>
<span id="cb218-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-3" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">13</span>)) </span>
<span id="cb218-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-4" tabindex="-1"></a></span>
<span id="cb218-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb218-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-6" tabindex="-1"></a></span>
<span id="cb218-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb218-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i),  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplot-clsM-Deographic"></span>
<img src="07-SOM_files/figure-html/boxplot-clsM-Deographic-1.png" alt="Demographics" width="672" />
<p class="caption">
Figure 8.5: Demographics
</p>
</div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-1" tabindex="-1"></a><span class="co"># Box plot by categories: &quot;Socio-economics&quot;</span></span>
<span id="cb219-2"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-2" tabindex="-1"></a></span>
<span id="cb219-3"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-3" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">18</span>)) </span>
<span id="cb219-4"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-4" tabindex="-1"></a></span>
<span id="cb219-5"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb219-6"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-6" tabindex="-1"></a></span>
<span id="cb219-7"><a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#cb219-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i),  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:boxplot-clsM-SocioEconomic"></span>
<img src="07-SOM_files/figure-html/boxplot-clsM-SocioEconomic-1.png" alt="Socio-economics" width="672" />
<p class="caption">
Figure 8.6: Socio-economics
</p>
</div>
</div>
<div id="conclusions" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Conclusions<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Results of the present study reveal the main patterns of the population in Switzerland based on the surveyed land-use, socio-economic, and demographic indicators.
To characterize the final main clusters, the distribution of each variable within them have been assessed by using <strong>box plots</strong>.
We could thus identify main clusters including the most developed and active cities with higher income, the peri-urban areas mostly devoted to the agricultural activity, or the areas with higher levels of migration.</p>
<p><strong>SOM heatmaps</strong> allow to display the pattern distribution of each input variable over the SOM-grid and how values change in space.
Visualized side by side, heatmaps show a picture of the different areas and their characteristics.
In this way it is possible to explore the level of complementarity that links one or more variables among them.</p>
<p>In conclusion, in the present study we proposed a performant data-driven approach based on unsupervised learning allowing to extract useful information from a huge volume of multivariate population census data.
This approach led to represent and interpret the main patterns characterizing the dynamic of population in Switzerland in the recent period.</p>
</div>
<div id="further-analyses" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Further analyses<a href="defining-territorial-typologies-using-unsupervised-learning-a-som-approach.html#further-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To ensure that everything is perfectly clear, we propose you to answer the following questions and to discuss your answers with the other participants to the course or directly with the teacher.</p>
<ol style="list-style-type: decimal">
<li><p>Change the size of the gridmap and check if you get better results for SOM.
<strong>N.B.</strong> Better results are achieved when the quantisation error decreases, the explained variance increases, and there are no empty observations revealed by the Node Counts map.</p></li>
<li><p>Focusing on Cluster 6: which variable characterize it the most?
Based on these variables, which class of land use can be associated to this cluster?
And in the case of Cluster 4?</p></li>
<li><p>Describe the distribution of the clusters in the geographical space.
In more details, describe to which kind of land use the different clusters can be referred and specify why.</p></li>
<li><p>From the visual inspection of the heatmaps, describe the correlation you can observe between the following variables: a) “p_transport” and “p_infrastructure”; b) “p_agriculture” and “p_improductible”.</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-FSO_2024" class="csl-entry">
Federal Statistical Office. (2024). <em>Statistical atlas of switzerland</em>. <a href="https://www.bfs.admin.ch/bfs/en/home/statistiken/regionalstatistik/atlanten/statistischer-atlas-schweiz.html">https://www.bfs.admin.ch/bfs/en/home/statistiken/regionalstatistik/atlanten/statistischer-atlas-schweiz.html</a>
</div>
<div id="ref-kohonen_self-organized_1982" class="csl-entry">
Kohonen, T. (1982). Self-organized formation of topologically correct feature maps. <em>Biological Cybernetics</em>, <em>43</em>(1), 59–69. <a href="https://doi.org/10.1007/BF00337288">https://doi.org/10.1007/BF00337288</a>
</div>
<div id="ref-library_SOM" class="csl-entry">
Wehrens, R., &amp; Buydens, L. M. C. (2007). Self- and super-organizing maps in <span>R</span>: The <span class="nocase">kohonen</span> package. In <em>Journal of Statistical Software</em> (5; Vol. 21, pp. 1–19). <a href="https://doi.org/10.18637/jss.v021.i05">https://doi.org/10.18637/jss.v021.i05</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="local-random-forest.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dbscan-for-3d-features-detection-in-geosciences.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/EugeneGIS/AGDAbook/edit/master/07-SOM.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fake-book.pdf", "fake-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
